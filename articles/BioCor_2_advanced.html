<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced usage of BioCor • BioCor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Advanced usage of BioCor">
<meta property="og:description" content="BioCor">
<meta property="og:image" content="/reference/figures/logo.png">
<meta property="og:image:alt" content="BioCor logo">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@Lluis_Rev">
<meta name="twitter:site" content="@Lluis_Rev">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioCor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BioCor_1_basics.html">About BioCor</a>
    </li>
    <li>
      <a href="../articles/BioCor_2_advanced.html">Advanced usage of BioCor</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/llrs/BioCor/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Advanced usage of BioCor</h1>
                        <h4 class="author">Lluís Revilla</h4>
            <address class="author_afil">
      August Pi i Sunyer Biomedical Research Institute (IDIBAPS); Liver Unit, Hospital Clinic<br><a class="author_email" href="mailto:#"></a><a href="mailto:lrevilla@clinic.cat">lrevilla@clinic.cat</a>
      </address>
                              <h4 class="author">Juan José Lozano</h4>
            <address class="author_afil">
      Centro de Investigación Biomédica en Red de Enfermedades Hepaticas y Digestivas (CIBEREHD); Barcelona, Spain<br><h4 class="author">Pau Sancho-Bru</h4>
            <address class="author_afil">
      August Pi i Sunyer Biomedical Research Institute (IDIBAPS); Liver Unit, Hospital Clinic<br><h4 class="date">26 September 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/llrs/BioCor/blob/master/vignettes/BioCor_2_advanced.Rmd"><code>vignettes/BioCor_2_advanced.Rmd</code></a></small>
      <div class="hidden name"><code>BioCor_2_advanced.Rmd</code></div>

    </address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      Describes how to use the BioCor package to answer several biological questions and how to use functional similarities with other measures.
    </div>
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this vignette we assume that the reader is already familiarized with the <a href="https://bioconductor.org/packages/3.12/BioCor/vignettes/BioCor_1_basics.html">introduction vignette</a>, but wants to know how can it help to answer other questions in other situations</p>
<p>We follow the same convention about names of the objects used <code>genesReact</code> and <code>genesKegg</code> are the list with information about the pathways the genes are involved in.</p>
</div>
<div id="merging" class="section level1">
<h1 class="hasAnchor">
<a href="#merging" class="anchor"></a>Merging similarities</h1>
<p>If one calculates similarities with KEGG data and Reactome or other input for the same genes or clusters BioCor provides a couple of functions to merge them.</p>
<p>We can set a weight to each similarity input with <code>weighted.sum</code>, multiply them also using a weight for each similarity (with <code>weighted.prod</code>), doing the mean or just adding them up. Similarities allow us to apply a function to combine the matrices of a list. Here we use some of the genes used in the first vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="va">kegg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span>, <span class="st">"10"</span><span class="op">)</span>, <span class="va">genesKegg</span><span class="op">)</span>
<span class="va">react</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span>, <span class="st">"10"</span><span class="op">)</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="co">## We can sum it adding a weight to each origin</span>
<span class="fu"><a href="../reference/weighted.html">weighted.sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">kegg</span><span class="op">[</span><span class="st">"672"</span>, <span class="st">"675"</span><span class="op">]</span>, <span class="va">react</span><span class="op">[</span><span class="st">"672"</span>, <span class="st">"675"</span><span class="op">]</span><span class="op">)</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] 0.7247289</span>

<span class="co">## Or if we want to perform for all the matrix</span>
<span class="co">## A list of matrices to merge</span>
<span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"kegg"</span> <span class="op">=</span> <span class="va">kegg</span>, <span class="st">"react"</span> <span class="op">=</span> <span class="va">react</span><span class="op">)</span>
<span class="fu"><a href="../reference/similarities.html">similarities</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">weighted.sum</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>
<span class="co">##            672        675         10</span>
<span class="co">## 672 1.00000000 0.72472885 0.09915273</span>
<span class="co">## 675 0.72472885 1.00000000 0.05207883</span>
<span class="co">## 10  0.09915273 0.05207883 1.00000000</span>
<span class="fu"><a href="../reference/similarities.html">similarities</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">weighted.prod</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>
<span class="co">##           672          675           10</span>
<span class="co">## 672 0.2100000 0.0173101952 0.0000000000</span>
<span class="co">## 675 0.0173102 0.2100000000 0.0001226529</span>
<span class="co">## 10  0.0000000 0.0001226529 0.2100000000</span>
<span class="fu"><a href="../reference/similarities.html">similarities</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">prod</span><span class="op">)</span>
<span class="co">##           672          675           10</span>
<span class="co">## 672 1.0000000 0.0824295011 0.0000000000</span>
<span class="co">## 675 0.0824295 1.0000000000 0.0005840616</span>
<span class="co">## 10  0.0000000 0.0005840616 1.0000000000</span>
<span class="fu"><a href="../reference/similarities.html">similarities</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">mean</span><span class="op">)</span>
<span class="co">##            672        675         10</span>
<span class="co">## 672 1.00000000 0.54121475 0.07082338</span>
<span class="co">## 675 0.54121475 1.00000000 0.03955395</span>
<span class="co">## 10  0.07082338 0.03955395 1.00000000</span></pre></div>
<p>This functions are similar to <code>weighted.mean</code>, except that first the multiplication by the weights is done and then the <code>NA</code>s are removed:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## [1] 1</span>
<span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="cn">NA</span><span class="op">)</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## [1] 0.8333333</span>
<span class="fu"><a href="../reference/weighted.html">weighted.sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] 0.5</span>
<span class="fu"><a href="../reference/weighted.html">weighted.sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="cn">NA</span><span class="op">)</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] 0.625</span>
<span class="fu"><a href="../reference/weighted.html">weighted.prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] 0.5</span>
<span class="fu"><a href="../reference/weighted.html">weighted.prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="cn">NA</span><span class="op">)</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] 0.0625</span></pre></div>
</div>
<div id="assessing-a-differential-study" class="section level1">
<h1 class="hasAnchor">
<a href="#assessing-a-differential-study" class="anchor"></a>Assessing a differential study</h1>
<p>In this example we will use the functional similarities in a classical differential study.</p>
<div id="obtaining-data" class="section level2">
<h2 class="hasAnchor">
<a href="#obtaining-data" class="anchor"></a>Obtaining data</h2>
<p>We start using data from the <a href="https://bioconductor.org/help/workflows/rnaseqGene/#differential-expression-analysis">RNAseq workflow</a> and following the analysis comparing treated and untreated:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"airway"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"airway"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/mikelove/DESeq2">"DESeq2"</a></span><span class="op">)</span>

<span class="va">dds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSet</a></span><span class="op">(</span><span class="va">airway</span>, design <span class="op">=</span> <span class="op">~</span> <span class="va">cell</span> <span class="op">+</span> <span class="va">dex</span><span class="op">)</span>
<span class="va">dds</span><span class="op">$</span><span class="va">dex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">dds</span><span class="op">$</span><span class="va">dex</span>, <span class="st">"untrt"</span><span class="op">)</span>
<span class="va">dds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span><span class="va">dds</span><span class="op">)</span>
<span class="co">## estimating size factors</span>
<span class="co">## estimating dispersions</span>
<span class="co">## gene-wise dispersion estimates</span>
<span class="co">## mean-dispersion relationship</span>
<span class="co">## final dispersion estimates</span>
<span class="co">## fitting model and testing</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/results.html">results</a></span><span class="op">(</span><span class="va">dds</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/summary.html">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## out of 33469 with nonzero total read count</span>
<span class="co">## adjusted p-value &lt; 0.05</span>
<span class="co">## LFC &gt; 0 (up)       : 2211, 6.6%</span>
<span class="co">## LFC &lt; 0 (down)     : 1817, 5.4%</span>
<span class="co">## outliers [1]       : 0, 0%</span>
<span class="co">## low counts [2]     : 16676, 50%</span>
<span class="co">## (mean count &lt; 7)</span>
<span class="co">## [1] see 'cooksCutoff' argument of ?results</span>
<span class="co">## [2] see 'independentFiltering' argument of ?results</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">log2FoldChange</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">padj</span><span class="op">)</span>,
    pch <span class="op">=</span> <span class="fl">16</span>, xlab <span class="op">=</span> <span class="st">"log2FC"</span>,
    ylab <span class="op">=</span> <span class="st">"-log10(p.ajd)"</span>, main <span class="op">=</span> <span class="st">"Untreated vs treated"</span>
<span class="op">)</span>
<span class="va">logFC</span> <span class="op">&lt;-</span> <span class="fl">2.5</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">logFC</span>, <span class="va">logFC</span><span class="op">)</span>, h <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/simulate-1.png" alt="Volcano plot. The airway data" width="700"><p class="caption">
Volcano plot. The airway data
</p>
</div>
<p>As we can see here there are around 4000 genes differentially expressed genes, some of them differentially expressed above 2^2.5.</p>
</div>
<div id="selecting-differentially-expressed-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#selecting-differentially-expressed-genes" class="anchor"></a>Selecting differentially expressed genes</h2>
<p>Usually in such a study one selects genes above certain logFC or fold change threshold, here we use the absolute value of 2.5:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">fc</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">logFC</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">padj</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">fc</span> <span class="op">&lt;-</span> <span class="va">fc</span><span class="op">[</span><span class="va">fc</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span>
<span class="co"># Convert Ids (used later)</span>
<span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">org.Hs.eg.db</span>,
    keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>, keytype <span class="op">=</span> <span class="st">"ENSEMBL"</span>,
    column <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ENTREZID"</span>, <span class="st">"SYMBOL"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">## 'select()' returned 1:many mapping between keys and columns</span>
<span class="va">genesFC</span> <span class="op">&lt;-</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">genesFC</span> <span class="op">&lt;-</span> <span class="va">genesFC</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">genesFC</span><span class="op">$</span><span class="va">ENTREZID</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">genesSim</span> <span class="op">&lt;-</span> <span class="va">genesFC</span><span class="op">$</span><span class="va">ENTREZID</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genesSim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">genesFC</span><span class="op">$</span><span class="va">SYMBOL</span>
<span class="va">genesSim</span> <span class="op">&lt;-</span> <span class="va">genesSim</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">genesSim</span><span class="op">)</span><span class="op">]</span>
<span class="co"># Calculate the functional similarity</span>
<span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genesSim</span>, info <span class="op">=</span> <span class="va">genesReact</span>, method <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>
<span class="co">## Warning in mgeneSim(genes = genesSim, info = genesReact, method = "BMA"): Some</span>
<span class="co">## genes are not in the list provided.</span></pre></div>
<p>Once the similarities for the selected genes are calculated we can now visualize the effect of each method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">nas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">sim</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">sim</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">[</span><span class="op">!</span><span class="va">nas</span>, <span class="op">!</span><span class="va">nas</span><span class="op">]</span>

<span class="va">MDSs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">sim</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">MDSs</span>, type <span class="op">=</span> <span class="st">"n"</span>, main <span class="op">=</span> <span class="st">"BMA similarity"</span>, xlab <span class="op">=</span> <span class="st">"MDS1"</span>, ylab <span class="op">=</span> <span class="st">"MDS2"</span><span class="op">)</span>
<span class="va">up</span> <span class="op">&lt;-</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span><span class="op">[</span><span class="va">fc</span><span class="op">$</span><span class="va">log2FoldChange</span> <span class="op">&gt;=</span> <span class="va">logFC</span><span class="op">]</span>, <span class="st">"SYMBOL"</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">MDSs</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">MDSs</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">MDSs</span><span class="op">)</span> <span class="op">%in%</span> <span class="va">up</span>, <span class="st">"black"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, v <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"top"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Up-regulated"</span>, <span class="st">"Down-regulated"</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/pval1-1.png" alt="Functional similarity of genes with logFC above 2,5. Similar genes cluster together." width="1440"><p class="caption">
Functional similarity of genes with logFC above 2,5. Similar genes cluster together.
</p>
</div>
<p>This plot illustrate that some differentially expressed genes are quite similar according to their pathways. Suggesting that there might be a relationship between them. Furthermore, some up-regulated genes seem functionally related to down-regulated genes indicating a precise regulation of the pathways where they are involved.</p>
<p>Note that here we are only using 73 genes from the original 127.</p>
</div>
<div id="are-differentially-expressed-genes-selected-by-their-functionality" class="section level2">
<h2 class="hasAnchor">
<a href="#are-differentially-expressed-genes-selected-by-their-functionality" class="anchor"></a>Are differentially expressed genes selected by their functionality?</h2>
<p>In the previous section we have seen that some differentially expressed genes are functionally related and that they have a high logFC value. Are genes differentially expressed more functional related than those which aren’t differential expressed?</p>
<p>For simplicity we will use a subset of 400 genes represented again in a volcano plot and we will look for the functional similarities between those genes:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span>
<span class="va">subRes</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">log2FoldChange</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">subs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample.int</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">400</span><span class="op">)</span>
<span class="va">subRes</span> <span class="op">&lt;-</span> <span class="va">subRes</span><span class="op">[</span><span class="va">subs</span>, <span class="op">]</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">)</span>, <span class="st">"ENTREZID"</span><span class="op">]</span>
<span class="va">gS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="va">g</span><span class="op">[</span><span class="va">g</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genesReact</span><span class="op">)</span><span class="op">]</span>, <span class="va">genesReact</span>, <span class="st">"BMA"</span><span class="op">)</span>
<span class="va">deg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">[</span><span class="va">subRes</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">$</span><span class="va">padj</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span>
<span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span> <span class="op">%in%</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="va">deg</span>, <span class="st">"ENTREZID"</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">$</span><span class="va">log2FoldChange</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">$</span><span class="va">padj</span><span class="op">)</span>,
    pch <span class="op">=</span> <span class="fl">16</span>, xlab <span class="op">=</span> <span class="st">"log2FC"</span>,
    ylab <span class="op">=</span> <span class="st">"-log10(p.ajd)"</span>, main <span class="op">=</span> <span class="st">"Untreated vs treated"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">logFC</span>, <span class="va">logFC</span><span class="op">)</span>, h <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/setting-1.png" alt="Volcano plot of the subset of 400 genes. This subset will be used in the following sections" width="700"><p class="caption">
Volcano plot of the subset of 400 genes. This subset will be used in the following sections
</p>
</div>
<p>We can answer this by testing it empirically:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"boot"</span><span class="op">)</span>
<span class="co"># The mean of genes differentially expressed</span>
<span class="op">(</span><span class="va">scoreDEG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gS</span><span class="op">[</span><span class="op">!</span><span class="va">keep</span>, <span class="va">keep</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] 0.1193273</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gS</span>, R <span class="op">=</span> <span class="fl">1000</span>, statistic <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">g</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">g</span>, <span class="va">i</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="op">(</span><span class="va">p.val</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">scoreDEG</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1001</span><span class="op">)</span>
<span class="co">## [1] 0.9480519</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">t</span>, main <span class="op">=</span> <span class="st">"Distribution of scores"</span>, xlab <span class="op">=</span> <span class="st">"Similarity score"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">scoreDEG</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/cluster2-1.png" alt="Distribution of scores between differentially expressed genes and those who aren't. The line indicates the mean score of the similarity between differentially expressed genes and those which aren't differentially expressed." width="700"><p class="caption">
Distribution of scores between differentially expressed genes and those who aren’t. The line indicates the mean score of the similarity between differentially expressed genes and those which aren’t differentially expressed.
</p>
</div>
<p>Comparing the genes differentially expressed and those who aren’t doesn’t show that they are non-randomly selected (p-value 0.9480519). The genes with a p-value below the threshold are not more closely functionally related than all the other genes<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="are-functionally-related-the-selected-differentially-expressed-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#are-functionally-related-the-selected-differentially-expressed-genes" class="anchor"></a>Are functionally related the selected differentially expressed genes?</h2>
<p>We have seen that the genes differentially expressed aren’t selected by their functionality. However they could be more functionally related than the other genes. Are the differentially expressed genes more functionally similar than it would be expected ?</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="op">(</span><span class="va">scoreW</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combineScores.html">combineScores</a></span><span class="op">(</span><span class="va">gS</span><span class="op">[</span><span class="va">keep</span>, <span class="va">keep</span><span class="op">]</span>, <span class="st">"avg"</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] 0.1563655</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gS</span>, R <span class="op">=</span> <span class="fl">1000</span>, statistic <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="op">(</span><span class="va">p.val</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">scoreW</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1001</span><span class="op">)</span> <span class="co"># P-value</span>
<span class="co">## [1] 0.01998002</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">t</span>, main <span class="op">=</span> <span class="st">"Distribution of scores"</span>, xlab <span class="op">=</span> <span class="st">"Similarity score"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">scoreW</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/pval2-1.png" alt="Distribution of the similarity within differentially expressed genes. The line indicates the mean funtional similarity whitin them." width="700"><p class="caption">
Distribution of the similarity within differentially expressed genes. The line indicates the mean funtional similarity whitin them.
</p>
</div>
<p>If we selected randomly the genes from our pool we would expect a score around 0.1563655 with a probability of 0.01998. That means that the differentially expressed genes is highly different compared to the other genes if we use a significance threshold of 0.05 <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
</div>
<div id="influence-of-the-fold-change-in-the-functionally-similarity-of-the-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#influence-of-the-fold-change-in-the-functionally-similarity-of-the-genes" class="anchor"></a>Influence of the fold change in the functionally similarity of the genes</h2>
<p>We have seen that the genes differentially expressed are not selected by functional similarity but they are functionally related. Now we would like to know if selecting a fold change threshold affects the functional similarity between them.</p>
<p>To know the relationship between the fold change and the similarity between genes we have several methods:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">$</span><span class="va">log2FoldChange</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.05</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">s</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">deg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">$</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">x</span>, <span class="op">]</span><span class="op">)</span>
    <span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span> <span class="op">%in%</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="va">deg</span>, <span class="st">"ENTREZID"</span><span class="op">]</span>
    <span class="va">BetweenAbove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gS</span><span class="op">[</span><span class="va">keep</span>, <span class="va">keep</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">AboveBelow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gS</span><span class="op">[</span><span class="va">keep</span>, <span class="op">!</span><span class="va">keep</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">BetweenBelow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gS</span><span class="op">[</span><span class="op">!</span><span class="va">keep</span>, <span class="op">!</span><span class="va">keep</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">"BetweenAbove"</span> <span class="op">=</span> <span class="va">BetweenAbove</span>, <span class="st">"AboveBelow"</span> <span class="op">=</span> <span class="va">AboveBelow</span>,
        <span class="st">"BetweenBelow"</span> <span class="op">=</span> <span class="va">BetweenBelow</span>
    <span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>logfc <span class="op">=</span> <span class="va">s</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">L</span><span class="op">$</span><span class="va">logfc</span>, <span class="va">L</span><span class="op">$</span><span class="va">BetweenAbove</span>,
    type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"abs(log2) fold change"</span>,
    ylab <span class="op">=</span> <span class="st">"Similarity score"</span>,
    main <span class="op">=</span> <span class="st">"Similarity scores along logFC"</span>, col <span class="op">=</span> <span class="st">"darkred"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">L</span><span class="op">$</span><span class="va">logfc</span>, <span class="va">L</span><span class="op">$</span><span class="va">AboveBelow</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">L</span><span class="op">$</span><span class="va">logfc</span>, <span class="va">L</span><span class="op">$</span><span class="va">BetweenBelow</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,
    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">"Between genes above and below threshold"</span>,
        <span class="st">"Whitin genes above threshold"</span>,
        <span class="st">"Whitin genes below threshold"</span>
    <span class="op">)</span>,
    fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"darkred"</span>, <span class="st">"black"</span><span class="op">)</span>
<span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/logfc1-1.png" alt="Similarity of genes along abs(logFC). Assessing the similarity of genes according to their absolute log2 fold change." width="700"><p class="caption">
Similarity of genes along abs(logFC). Assessing the similarity of genes according to their absolute log2 fold change.
</p>
</div>
<p>The functional similarity of the genes above the threshold increases with a more restrictive threshold, indicating that a logFC threshold selects genes by their functionality, or in other words that genes differentially expressed tend to be of related pathways. The similarity between those genes above the threshold and below remains constant as well as within genes below the threshold.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">s</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># Names of genes up and down regulated</span>
    <span class="va">degUp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">[</span><span class="va">subRes</span><span class="op">$</span><span class="va">log2FoldChange</span> <span class="op">&gt;=</span> <span class="va">x</span>, <span class="op">]</span><span class="op">)</span>
    <span class="va">degDown</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">[</span><span class="va">subRes</span><span class="op">$</span><span class="va">log2FoldChange</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="va">x</span>, <span class="op">]</span><span class="op">)</span>

    <span class="co"># Translate to ids in gS</span>
    <span class="va">keepUp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span> <span class="op">%in%</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="va">degUp</span>, <span class="st">"ENTREZID"</span><span class="op">]</span>
    <span class="va">keepDown</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span> <span class="op">%in%</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="va">degDown</span>, <span class="st">"ENTREZID"</span><span class="op">]</span>

    <span class="co"># Calculate the mean similarity between each subgrup</span>
    <span class="va">between</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gS</span><span class="op">[</span><span class="va">keepUp</span>, <span class="va">keepDown</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UpVsDown"</span> <span class="op">=</span> <span class="va">between</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="st">"logfc"</span> <span class="op">=</span> <span class="va">s</span>, <span class="st">"UpVsDown"</span> <span class="op">=</span> <span class="va">l</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">L</span><span class="op">$</span><span class="va">logfc</span>, <span class="va">L</span><span class="op">$</span><span class="va">UpVsDown</span>,
    type <span class="op">=</span> <span class="st">"l"</span>,
    xlab <span class="op">=</span> <span class="st">"abs(log2) fold change threshold"</span>,
    ylab <span class="op">=</span> <span class="st">"Similarity score"</span>,
    main <span class="op">=</span> <span class="st">"Similarity scores along logFC"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,
    legend <span class="op">=</span> <span class="st">"Up vs down regulated genes"</span>,
    fill <span class="op">=</span> <span class="st">"black"</span>
<span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/logfc2-1.png" alt="Functional similarity between the up-regulated and down-regulated genes." width="700"><p class="caption">
Functional similarity between the up-regulated and down-regulated genes.
</p>
</div>
<p>The maximal functional similarity between genes up-regulated and down-regulated are at 1.15 log2 fold change.</p>
</div>
</div>
<div id="assessing-a-new-pathway" class="section level1">
<h1 class="hasAnchor">
<a href="#assessing-a-new-pathway" class="anchor"></a>Assessing a new pathway</h1>
<p>Sometimes the top differentially expressed genes or some other key genes are selected as a signature or a potential new group of related genes. In those cases we can test how does the network of genes change if we add them. Here we create a new pathway named <code>deg</code>, and we see the effect on the functional similarity score for all the genes:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co"># Adding a new pathway "deg" to those genes</span>
<span class="va">genesReact2</span> <span class="op">&lt;-</span> <span class="va">genesReact</span>
<span class="va">diffGenes</span> <span class="op">&lt;-</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="va">deg</span>, <span class="st">"ENTREZID"</span><span class="op">]</span>
<span class="va">genesReact2</span><span class="op">[</span><span class="va">diffGenes</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">genesReact</span><span class="op">[</span><span class="va">diffGenes</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"deg"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span><span class="op">(</span><span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genesReact</span><span class="op">)</span>, <span class="va">genesReact</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span><span class="op">(</span><span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genesReact2</span><span class="op">)</span>, <span class="va">genesReact2</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></pre></div>
<p>This would take lot of time, for a illustration purpose we reduce to some genes:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://hbiostat.org/R/Hmisc/">"Hmisc"</a></span><span class="op">)</span>
<span class="va">genesReact2</span> <span class="op">&lt;-</span> <span class="va">genesReact</span>
<span class="va">diffGenes</span> <span class="op">&lt;-</span> <span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="va">deg</span>, <span class="st">"ENTREZID"</span><span class="op">]</span>
<span class="co"># Create the new pathway called deg</span>
<span class="va">genesReact2</span><span class="op">[</span><span class="va">diffGenes</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">genesReact</span><span class="op">[</span><span class="va">diffGenes</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"deg"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">genes</span><span class="op">[</span><span class="va">genes</span><span class="op">$</span><span class="va">ENSEMBL</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">subRes</span><span class="op">)</span>, <span class="st">"ENTREZID"</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/Ecdf.html">Ecdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="va">ids</span>, <span class="va">genesReact</span>, method <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="va">ids</span>, <span class="va">genesReact2</span>, method <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>
<span class="op">)</span>,
group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Reactome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Modified"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Functional similarities"</span>, main <span class="op">=</span> <span class="st">"Empirical cumulative distribution"</span>
<span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/newPathway2-1.png" alt="The effect of adding a new pathway to a functional similarity. In red the same network as in black but with the added pathway." width="700"><p class="caption">
The effect of adding a new pathway to a functional similarity. In red the same network as in black but with the added pathway.
</p>
</div>
</div>
<div id="merging-sources-of-information" class="section level1">
<h1 class="hasAnchor">
<a href="#merging-sources-of-information" class="anchor"></a>Merging sources of information</h1>
<p>Sometimes we have several origin of information, either several databases, or information from other programs… We can merge this in the single object required by the function in <code>BioCor</code> using the function <code>combineSources</code><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<p>This functions helps to evaluate what happens when we add more pathway information. For instance here we add the information in Kegg and the information in Reactome and we visualize it using the same procedure as previously:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="va">genesKegg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">org.Hs.egPATH</span><span class="op">)</span>
<span class="va">gSK</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span>, <span class="va">genesKegg</span><span class="op">)</span>
<span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combineSources.html">combineSources</a></span><span class="op">(</span><span class="va">genesKegg</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="co">## Warning in combineSources(genesKegg, genesReact): More than 50% of genes identifiers of a source are unique</span>
<span class="co">## Check the identifiers of the genes</span>
<span class="va">gSMix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span>, <span class="va">mix</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/Ecdf.html">Ecdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gS</span>, <span class="va">gSK</span>, <span class="va">gSMix</span><span class="op">)</span>,
    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Reactome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Kegg"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gSK</span><span class="op">)</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Mix"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gSMix</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Functional similarities"</span>, main <span class="op">=</span> <span class="st">"ecdf"</span>
<span class="op">)</span>
<span class="co">## Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span>
<span class="co">## collapsing to unique 'x' values</span>
<span class="co">## Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span>
<span class="co">## collapsing to unique 'x' values</span>

<span class="co">## Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span>
<span class="co">## collapsing to unique 'x' values</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/combineSource-1.png" alt="Comparison of functional similarity in different databases." width="700"><p class="caption">
Comparison of functional similarity in different databases.
</p>
</div>
<p>When mixed, there is a huge increase in the genes that share a pathway using the <code>max</code> method. Observe in next figure (@ref(fig:combineSource2)) how does the method affects to the results:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">gSK2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span>, <span class="va">genesKegg</span>, method <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>
<span class="va">gS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span>, <span class="va">genesReact</span>, method <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>
<span class="va">gSMix2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span>, <span class="va">mix</span>, method <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/Ecdf.html">Ecdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gS2</span>, <span class="va">gSK2</span>, <span class="va">gSMix2</span><span class="op">)</span>,
    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Reactome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Kegg"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gSK</span><span class="op">)</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Mix"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gSMix</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Functional similarities (BMA)"</span>, main <span class="op">=</span> <span class="st">"ecdf"</span>
<span class="op">)</span>
<span class="co">## Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span>
<span class="co">## collapsing to unique 'x' values</span>

<span class="co">## Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span>
<span class="co">## collapsing to unique 'x' values</span>

<span class="co">## Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span>
<span class="co">## collapsing to unique 'x' values</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/combineSource2-1.png" alt="Comparison of functional similarity in different gene sets." width="700"><p class="caption">
Comparison of functional similarity in different gene sets.
</p>
</div>
<p>Now we can appreciate that most of the functional similarity is brought by Reactome database</p>
</div>
<div id="mirna-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#mirna-analysis" class="anchor"></a>miRNA analysis</h1>
<p>miRNAs are RNAs that interact with many genes and transcripts and is subject to change with location and time, thus defining the effect of an miRNA is difficult. In this section we try to answer how functionally similar are miRNA between them to provide a help for potentially closely related miRNA.</p>
<p>First we look for human miRNAs and prepare them for using them as the input for the cluster functions (Restricting to 10 miRNA with less than 150 genes).<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"targetscan.Hs.eg.db"</span><span class="op">)</span>
<span class="co">## select human mirna</span>
<span class="va">humanMirnaIdx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"hsa"</span>, <span class="fu">mappedkeys</span><span class="op">(</span><span class="va">targetscan.Hs.egMIRNA</span><span class="op">)</span><span class="op">)</span>
<span class="co">## select seed-based families for human mirna</span>
<span class="va">humanMirna</span> <span class="op">&lt;-</span> <span class="fu">mappedkeys</span><span class="op">(</span><span class="va">targetscan.Hs.egMIRNA</span><span class="op">)</span><span class="op">[</span><span class="va">humanMirnaIdx</span><span class="op">]</span>
<span class="co">## select targets of families</span>
<span class="va">humanMirnaFamilies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">mget</a></span><span class="op">(</span><span class="va">humanMirna</span>, <span class="va">targetscan.Hs.egMIRBASE2FAMILY</span><span class="op">)</span><span class="op">)</span>
<span class="va">humanMirnaTargets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">mget</a></span><span class="op">(</span><span class="va">humanMirnaFamilies</span>, <span class="fu">revmap</span><span class="op">(</span><span class="va">targetscan.Hs.egTARGETS</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">humanMirnaTargets</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">humanMirna</span>
<span class="co"># Restrict to miRNA with more than one target and less than 150</span>
<span class="va">miRNAs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">humanMirnaTargets</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="va">humanMirnaTargets</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;</span>
    <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="va">humanMirnaTargets</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">150</span><span class="op">]</span>, <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="va">miRNAs</span><span class="op">)</span>
<span class="co">##    hsa-miR-187 hsa-miR-127-3p   hsa-miR-551a    hsa-miR-191 hsa-miR-615-3p </span>
<span class="co">##             13             17             17            118             28 </span>
<span class="co">##    hsa-miR-99b   hsa-miR-551b   hsa-miR-487b    hsa-miR-184    hsa-miR-451 </span>
<span class="co">##             92             17             23             54             36</span></pre></div>
<p>Now we calculate the functional similarity of those miRNAs using a cluster approach.</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="va">cluster1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mclusterSim.html">mclusterSim</a></span><span class="op">(</span><span class="va">miRNAs</span>, <span class="va">genesReact</span>, method <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>
<span class="co">## Warning in mclusterSim(miRNAs, genesReact, method = "BMA"): Some genes are not</span>
<span class="co">## in the list provided.</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cluster1</span>, <span class="fl">2</span><span class="op">)</span>, caption <span class="op">=</span> <span class="st">"The similarity between miRNA"</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>
The similarity between miRNA
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
hsa-miR-187
</th>
<th style="text-align:right;">
hsa-miR-127-3p
</th>
<th style="text-align:right;">
hsa-miR-551a
</th>
<th style="text-align:right;">
hsa-miR-191
</th>
<th style="text-align:right;">
hsa-miR-615-3p
</th>
<th style="text-align:right;">
hsa-miR-99b
</th>
<th style="text-align:right;">
hsa-miR-551b
</th>
<th style="text-align:right;">
hsa-miR-487b
</th>
<th style="text-align:right;">
hsa-miR-184
</th>
<th style="text-align:right;">
hsa-miR-451
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
hsa-miR-187
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-127-3p
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-551a
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-191
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.71
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-615-3p
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.61
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-99b
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-551b
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-487b
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-184
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
hsa-miR-451
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
</tbody>
</table>
<p>So for instance hsa-miR-551b, hsa-miR-551a are functionally related despite being from different families.</p>
</div>
<div id="comparing-with-go-similarities" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-with-go-similarities" class="anchor"></a>Comparing with GO similarities</h1>
<p>As suggested in the main vignette functional similarities can be compared to semantic similarities such as those based on GO. Here a comparison using the biological process from the gene ontologies is done:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://guangchuangyu.github.io/software/GOSemSim">"GOSemSim"</a></span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## GOSemSim v2.15.2  For help: https://guangchuangyu.github.io/GOSemSim</span>
<span class="co">## </span>
<span class="co">## If you use GOSemSim in published research, please cite:</span>
<span class="co">## [36m-[39m Guangchuang Yu. Gene Ontology Semantic Similarity Analysis Using GOSemSim. In: Kidder B. (eds) Stem Cell Transcriptional Networks. Methods in Molecular Biology, 2020, 2117:207-215. Humana, New York, NY. doi:10.1007/978-1-0716-0301-7_11</span>
<span class="co">## [36m-[39m Guangchuang Yu, Fei Li, Yide Qin, Xiaochen Bo, Yibo Wu, Shengqi Wang. GOSemSim: an R package for measuring semantic similarity among GO terms and gene products Bioinformatics 2010, 26(7):976-978. doi:10.1093/bioinformatics/btq064</span>
<span class="co">## </span>
<span class="co">## Attaching package: 'GOSemSim'</span>
<span class="co">## The following objects are masked from 'package:BioCor':</span>
<span class="co">## </span>
<span class="co">##     clusterSim, combineScores, geneSim, mclusterSim, mgeneSim</span>
<span class="va">BP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GOSemSim/man/godata.html">godata</a></span><span class="op">(</span><span class="st">"org.Hs.eg.db"</span>, ont <span class="op">=</span> <span class="st">"BP"</span>, computeIC <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## preparing gene to GO mapping data...</span>
<span class="co">## preparing IC data...</span>
<span class="va">gsGO</span> <span class="op">&lt;-</span> <span class="fu">GOSemSim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GOSemSim/man/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span>, semData <span class="op">=</span> <span class="va">BP</span>, measure <span class="op">=</span> <span class="st">"Resnik"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gS</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gsGO</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">gS</span><span class="op">[</span><span class="va">keep</span>, <span class="va">keep</span><span class="op">]</span> <span class="op">-</span> <span class="va">gsGO</span><span class="op">)</span>,
    main <span class="op">=</span> <span class="st">"Difference between functional similarity and biological process"</span>,
    xlab <span class="op">=</span> <span class="st">"Functional similarity - biological process similarity"</span>
<span class="op">)</span></pre></div>
<div class="figure">
<img src="BioCor_2_advanced_files/figure-html/GOSemSim-1.png" alt="Comparison of similarities. Functional similarities compared to biological process semantic similarity." width="700"><p class="caption">
Comparison of similarities. Functional similarities compared to biological process semantic similarity.
</p>
</div>
<p>On this graphic we can observe that some genes have a large functional similarity and few biological similarity. They are present together in several pathways while they share few biological process, indicating that they might be key elements of the pathways they are in. On the other hand some other pairs of genes show higher biological process similarity than functional similarity, indicating specialization or compartmentalization of said genes.</p>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## R version 4.0.2 (2020-06-22)</span>
<span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">## Running under: Ubuntu 16.04.6 LTS</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /usr/lib/openblas-base/libblas.so.3</span>
<span class="co">## LAPACK: /usr/lib/libopenblasp-r0.2.18.so</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] parallel  stats4    stats     graphics  grDevices utils     datasets </span>
<span class="co">## [8] methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] GOSemSim_2.15.2             targetscan.Hs.eg.db_0.6.1  </span>
<span class="co">##  [3] Hmisc_4.4-1                 ggplot2_3.3.2              </span>
<span class="co">##  [5] Formula_1.2-3               survival_3.1-12            </span>
<span class="co">##  [7] lattice_0.20-41             boot_1.3-25                </span>
<span class="co">##  [9] DESeq2_1.29.13              airway_1.9.0               </span>
<span class="co">## [11] SummarizedExperiment_1.19.6 DelayedArray_0.15.8        </span>
<span class="co">## [13] matrixStats_0.57.0          Matrix_1.2-18              </span>
<span class="co">## [15] GenomicRanges_1.41.6        GenomeInfoDb_1.25.11       </span>
<span class="co">## [17] BioCor_1.13.0               org.Hs.eg.db_3.11.4        </span>
<span class="co">## [19] AnnotationDbi_1.51.3        IRanges_2.23.10            </span>
<span class="co">## [21] S4Vectors_0.27.13           Biobase_2.49.1             </span>
<span class="co">## [23] BiocGenerics_0.35.4         BiocStyle_2.17.1           </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] bitops_1.0-6           fs_1.5.0               bit64_4.0.5           </span>
<span class="co">##  [4] RColorBrewer_1.1-2     rprojroot_1.3-2        tools_4.0.2           </span>
<span class="co">##  [7] backports_1.1.10       R6_2.4.1               rpart_4.1-15          </span>
<span class="co">## [10] DBI_1.1.0              colorspace_1.4-1       nnet_7.3-14           </span>
<span class="co">## [13] withr_2.3.0            gridExtra_2.3          bit_4.0.4             </span>
<span class="co">## [16] compiler_4.0.2         graph_1.67.1           htmlTable_2.1.0       </span>
<span class="co">## [19] desc_1.2.0             bookdown_0.20          checkmate_2.0.0       </span>
<span class="co">## [22] scales_1.1.1           genefilter_1.71.0      pkgdown_1.6.1         </span>
<span class="co">## [25] systemfonts_0.3.1      stringr_1.4.0          digest_0.6.25         </span>
<span class="co">## [28] foreign_0.8-80         rmarkdown_2.3          XVector_0.29.3        </span>
<span class="co">## [31] base64enc_0.1-3        jpeg_0.1-8.1           pkgconfig_2.0.3       </span>
<span class="co">## [34] htmltools_0.5.0        highr_0.8              htmlwidgets_1.5.1     </span>
<span class="co">## [37] rlang_0.4.7            rstudioapi_0.11        RSQLite_2.2.0         </span>
<span class="co">## [40] BiocParallel_1.23.2    RCurl_1.98-1.2         magrittr_1.5          </span>
<span class="co">## [43] GO.db_3.11.4           GenomeInfoDbData_1.2.3 Rcpp_1.0.5            </span>
<span class="co">## [46] munsell_0.5.0          lifecycle_0.2.0        stringi_1.5.3         </span>
<span class="co">## [49] yaml_2.2.1             zlibbioc_1.35.0        grid_4.0.2            </span>
<span class="co">## [52] blob_1.2.1             crayon_1.3.4           splines_4.0.2         </span>
<span class="co">## [55] annotate_1.67.1        locfit_1.5-9.4         knitr_1.30            </span>
<span class="co">## [58] pillar_1.4.6           geneplotter_1.67.0     XML_3.99-0.5          </span>
<span class="co">## [61] glue_1.4.2             evaluate_0.14          latticeExtra_0.6-29   </span>
<span class="co">## [64] data.table_1.13.0      BiocManager_1.30.10    vctrs_0.3.4           </span>
<span class="co">## [67] png_0.1-7              gtable_0.3.0           assertthat_0.2.1      </span>
<span class="co">## [70] cpp11_0.2.1            xfun_0.17              xtable_1.8-4          </span>
<span class="co">## [73] reactome.db_1.70.0     ragg_0.3.1             tibble_3.0.3          </span>
<span class="co">## [76] memoise_1.1.0          cluster_2.1.0          ellipsis_0.3.1        </span>
<span class="co">## [79] GSEABase_1.51.1</span></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>From 400 genes there are 123 with pathway information and only 23 where significantly differentially expressed in this subset.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Remember that this is a small subset.<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>See the help page of <code>combineSources</code><a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>This preparation has been adapted from a <a href="https://support.bioconductor.org/p/48138/#48236">previous discussion</a>.<a href="#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lluís Revilla Sancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
