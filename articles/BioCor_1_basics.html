<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>About BioCor • BioCor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="About BioCor">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioCor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BioCor_1_basics.html">About BioCor</a>
    </li>
    <li>
      <a href="../articles/BioCor_2_advanced.html">Advanced usage of BioCor</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>About BioCor</h1>
                        <h4 class="author">Lluís Revilla</h4>
            <address class="author_afil">
      August Pi i Sunyer Biomedical Research Institute (IDIBAPS); Liver Unit, Hospital Clinic<br><a class="author_email" href="mailto:#"></a><a href="mailto:lrevilla@clinic.cat">lrevilla@clinic.cat</a>
      </address>
                              <h4 class="author">Juan José Lozano</h4>
            <address class="author_afil">
      Centro de Investigación Biomédica en Red de Enfermedades Hepaticas y Digestivas (CIBEREHD); Barcelona, Spain<br><h4 class="author">Pau Sancho-Bru</h4>
            <address class="author_afil">
      August Pi i Sunyer Biomedical Research Institute (IDIBAPS); Liver Unit, Hospital Clinic<br><h4 class="date">4 October 2019</h4>
      
      
      <div class="hidden name"><code>BioCor_1_basics.Rmd</code></div>

    </address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      Describes the background of the package, important functions defined in the package and some of the applications and usages, including the integration with other packages and analysis, and comparisons with related packages. Some frequent or important questions about the package are answered at the end of the document. For more advanced usage you can look at the other vignette.
    </div>
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Methods to find similarities have been developed for several purposes, being Jaccard and Dice similarities the most known. In bioinformatics much of the research on the topic is centered around <a href="http://www.geneontology.org/">Gene Ontologies</a> because they provide controlled vocabularies, as part of their mission:</p>
<blockquote>
<p>The mission of the GO Consortium is to develop an up-to-date, comprehensive, computational model of biological systems, from the molecular level to larger pathways, cellular and organism-level systems.</p>
</blockquote>
<p>However, there is another resource of similarities between genes: metabolic pathways. Metabolic pathways describe the relationship between genes, proteins, lipids and other elements of the cells. A pathway describes, to some extent, the function in which it is involved in the cell. There exists several databases about which gene belong to which pathway. Together with pathways, gene sets related to a function or to a phenotype are a source of information of the genes function. With this package we provide the methods to calculate functional similarities based on this information.</p>
<p>Here we provides functions to calculate <em>functional similarities distances</em> for pathways, gene sets, genes and clusters of genes. The name BioCor stands from biological correlation, shortened to BioCor, because as said we look if some genes are in the same pathways or gene sets as other genes.</p>
<p>BioCor is different from <em><a href="https://bioconductor.org/packages/3.10/GeneOverlap">GeneOverlap</a></em> because here we use the Dice index instead of the Jaccard index (although we provide a function to change from one to the other, see <a href="#D2J">this section</a>)and that package only allows to compare pathways but not genes or groups of genes. But <em><a href="https://bioconductor.org/packages/3.10/GeneOverlap">GeneOverlap</a></em> provides some functionalities to plot the similarity scores and provides the associated p-value to the comparison of pathways.</p>
<p>The development of this package aimed initially to improve clustering of genes by functionality in weighted gene co-expression networks using <em><a href="https://CRAN.R-project.org/package=WGCNA">WGCNA</a></em>. The package has some functions to combine similarities in order to integrate with <code>WGCNA</code>. For other uses you can check the <a href="https://bioconductor.org/packages/3.10/BioCor/vignettes/BioCor_2_advanced.html">advanced vignette.</a>.</p>
</div>
<div id="citation" class="section level1">
<h1 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h1>
<p>You can cite the package as:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span>(<span class="st">"BioCor"</span>)</a></code></pre></div>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>The BioCor package is available at <a href="https://bioconductor.org">Bioconductor</a> and can be downloaded and installed via BiocManager:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">BiocManager<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"BioCor"</span>)</a></code></pre></div>
<p>You can install the latest version of <em><a href="https://github.com/llrs/BioCor">BioCor</a></em> from Github with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"devtools"</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">install_github</span>(<span class="st">"llrs/BioCor"</span>)</a></code></pre></div>
</div>
<div id="using-biocor" class="section level1">
<h1 class="hasAnchor">
<a href="#using-biocor" class="anchor"></a>Using BioCor</h1>
<div id="preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#preparation" class="anchor"></a>Preparation</h2>
<p>We can load the package and prepare the data for which we want to calculate the similarities:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"BioCor"</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">## Load libraries with the data of the pathways</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"org.Hs.eg.db"</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"reactome.db"</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">genesKegg &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>(org.Hs.egPATH)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">genesReact &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>(reactomeEXTID2PATHID)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># Remove genes and pathways which are not from human pathways </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">genesReact &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(genesReact, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">    <span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"R-HSA-"</span>, x, <span class="dt">value =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">    })</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">genesReact &lt;-<span class="st"> </span>genesReact[<span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(genesReact) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>] </a></code></pre></div>
<p>To avoid having biased data it is important to have all the data about the pathways and genes associated to all pathways for the organism under study. Here we assume that we are interested in human pathways. We use this two databases KEGG and Reactome as they are easy to obtain the data. However KEGG database is no longer free for large retrievals therefore it is not longer updated in the Bioconductor annotation packages.</p>
<p>However, one can use any list where the names of the list are the genes and the elements of the list the pathways or groups where the gene belong. One could also read from a GMT file or use GeneSetCollections in addition or instead of those associations from a pathway database and convert it to list using:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"GSEABase"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">paths2Genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-class.html">geneIds</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/GSEABase/man/getObjects.html">getGmt</a></span>(<span class="st">"/path/to/file.symbol.gmt"</span>,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                 <span class="dt">geneIdType=</span><span class="kw"><a href="https://rdrr.io/pkg/GSEABase/man/GeneIdentifierType-constructors.html">SymbolIdentifier</a></span>()))</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(paths2Genes, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">pathways &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(paths2Genes), <span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(paths2Genes))</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">genes2paths &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/split.html">split</a></span>(pathways, genes) <span class="co"># List of genes and the gene sets</span></a></code></pre></div>
<p>With <code>genes2paths</code> we have the information ready to use.</p>
</div>
<div id="pathway-similarities" class="section level2">
<h2 class="hasAnchor">
<a href="#pathway-similarities" class="anchor"></a>Pathway similarities</h2>
<p>We can compute similarities (Dice similarity, see <a href="#FAQ1">question 1</a> of FAQ) between two pathways or between several pathways and combine them, or not:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">(paths &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(genesReact)), <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">## [1] "R-HSA-1483257" "R-HSA-5660883"</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="../reference/pathSim.html">pathSim</a></span>(paths[<span class="dv">1</span>], paths[<span class="dv">2</span>], genesReact)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">## [1] 0</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">(pathways &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(genesReact)), <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">##  [1] "R-HSA-532668"  "R-HSA-5654726" "R-HSA-5545483" "R-HSA-1643713"</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">##  [5] "R-HSA-5693571" "R-HSA-68884"   "R-HSA-9013973" "R-HSA-6791462"</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">##  [9] "R-HSA-6803529" "R-HSA-379398"</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="kw"><a href="../reference/mpathSim.html">mpathSim</a></span>(pathways, genesReact)</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">##               R-HSA-532668 R-HSA-5654726 R-HSA-5545483 R-HSA-1643713</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">## R-HSA-532668     1.0000000     0.1176471             0     0.1333333</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">## R-HSA-5654726    0.1176471     1.0000000             0     0.2068966</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">## R-HSA-5545483    0.0000000     0.0000000             1     0.0000000</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">## R-HSA-1643713    0.1333333     0.2068966             0     1.0000000</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">## R-HSA-5693571    0.0000000     0.0000000             0     0.0000000</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">## R-HSA-68884      0.0000000     0.0000000             0     0.0000000</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">## R-HSA-9013973    0.1702128     0.1777778             0     0.2162162</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">## R-HSA-6791462    0.0000000     0.0000000             0     0.0000000</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">## R-HSA-6803529    0.0000000     0.0000000             0     0.0000000</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">## R-HSA-379398     0.0000000     0.0000000             0     0.0000000</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">##               R-HSA-5693571 R-HSA-68884 R-HSA-9013973 R-HSA-6791462</a>
<a class="sourceLine" id="cb6-23" data-line-number="23">## R-HSA-532668              0           0     0.1702128             0</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">## R-HSA-5654726             0           0     0.1777778             0</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">## R-HSA-5545483             0           0     0.0000000             0</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">## R-HSA-1643713             0           0     0.2162162             0</a>
<a class="sourceLine" id="cb6-27" data-line-number="27">## R-HSA-5693571             1           0     0.0000000             0</a>
<a class="sourceLine" id="cb6-28" data-line-number="28">## R-HSA-68884               0           1     0.0000000             0</a>
<a class="sourceLine" id="cb6-29" data-line-number="29">## R-HSA-9013973             0           0     1.0000000             0</a>
<a class="sourceLine" id="cb6-30" data-line-number="30">## R-HSA-6791462             0           0     0.0000000             1</a>
<a class="sourceLine" id="cb6-31" data-line-number="31">## R-HSA-6803529             0           0     0.0000000             0</a>
<a class="sourceLine" id="cb6-32" data-line-number="32">## R-HSA-379398              0           0     0.0000000             0</a>
<a class="sourceLine" id="cb6-33" data-line-number="33">##               R-HSA-6803529 R-HSA-379398</a>
<a class="sourceLine" id="cb6-34" data-line-number="34">## R-HSA-532668              0            0</a>
<a class="sourceLine" id="cb6-35" data-line-number="35">## R-HSA-5654726             0            0</a>
<a class="sourceLine" id="cb6-36" data-line-number="36">## R-HSA-5545483             0            0</a>
<a class="sourceLine" id="cb6-37" data-line-number="37">## R-HSA-1643713             0            0</a>
<a class="sourceLine" id="cb6-38" data-line-number="38">## R-HSA-5693571             0            0</a>
<a class="sourceLine" id="cb6-39" data-line-number="39">## R-HSA-68884               0            0</a>
<a class="sourceLine" id="cb6-40" data-line-number="40">## R-HSA-9013973             0            0</a>
<a class="sourceLine" id="cb6-41" data-line-number="41">## R-HSA-6791462             0            0</a>
<a class="sourceLine" id="cb6-42" data-line-number="42">## R-HSA-6803529             1            0</a>
<a class="sourceLine" id="cb6-43" data-line-number="43">## R-HSA-379398              0            1</a></code></pre></div>
<p>When the method to combine the similarities is set to <code>NULL</code> mpathSim returns a matrix of pathway similarities, otherwise it combines the values. In the next section we can see the methods to combine pathway similarities.</p>
<div id="combining" class="section level3">
<h3 class="hasAnchor">
<a href="#combining" class="anchor"></a>Combining values</h3>
<p>To combine values we provide a function with several methods:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mpathSim.html">mpathSim</a></span>(pathways, genesReact)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">methodsCombineScores &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"avg"</span>, <span class="st">"max"</span>, <span class="st">"rcmax"</span>, <span class="st">"rcmax.avg"</span>, <span class="st">"BMA"</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                          <span class="st">"reciprocal"</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(methodsCombineScores, BioCor<span class="op">::</span>combineScores, <span class="dt">scores =</span> sim)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">##        avg        max      rcmax  rcmax.avg        BMA reciprocal </a>
<a class="sourceLine" id="cb7-6" data-line-number="6">##  0.1204417  1.0000000  1.0000000  1.0000000  1.0000000  1.0000000</a></code></pre></div>
<p>We can also specify the method to combine the similarities in <code>mpathSim</code>, <code>geneSim</code>, <code>mgeneSim</code>, <code>clusterSim</code>, <code>mclusterSim</code>, <code>clusterGeneSim</code> and <code>mclusterGeneSim</code>, argument method. By default the method is set to “max” to combine pathways (except in mpathSim where the default is to show all the pathway similarities) and “BMA” to combine similarities of genes or for cluster analysis. This function is adapted from <em><a href="https://bioconductor.org/packages/3.10/GOSemSim">GOSemSim</a></em> package.</p>
<p>The function <code>combineScoresPar</code> allows to use a parallel background (using <em><a href="https://bioconductor.org/packages/3.10/BiocParallel">BiocParallel</a></em>) to combine the scores. It is recommended to use a parallel background if you calculate more than 300 gene similarities. It also have an argument in case you want to calculate the similarity scores of several sets.</p>
</div>
</div>
<div id="geneSim" class="section level2">
<h2 class="hasAnchor">
<a href="#geneSim" class="anchor"></a>Gene similarities</h2>
<p>To compare the function of two genes there is the <code>geneSim</code> function and <code>mgeneSim</code> function for several comparisons. In this example we compare the genes BRCA1 and BRCA2 and NAT2, which are the genes 672, 675 and 10 respectively in ENTREZID:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/geneSim.html">geneSim</a></span>(<span class="st">"672"</span>, <span class="st">"675"</span>, genesKegg)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">## [1] 0.0824295</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="../reference/geneSim.html">geneSim</a></span>(<span class="st">"672"</span>, <span class="st">"675"</span>, genesReact)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">## [1] 1</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="kw"><a href="../reference/mgeneSim.html">mgeneSim</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BRCA1"</span> =<span class="st"> "672"</span>, <span class="st">"BRCA2"</span> =<span class="st"> "675"</span>, <span class="st">"NAT2"</span> =<span class="st"> "10"</span>), genesKegg)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">##           BRCA1       BRCA2        NAT2</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">## BRCA1 1.0000000 0.082429501 0.000000000</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">## BRCA2 0.0824295 1.000000000 0.008241758</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">## NAT2  0.0000000 0.008241758 1.000000000</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="kw"><a href="../reference/mgeneSim.html">mgeneSim</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BRCA1"</span> =<span class="st"> "672"</span>, <span class="st">"BRCA2"</span> =<span class="st"> "675"</span>, <span class="st">"NAT2"</span> =<span class="st"> "10"</span>), genesReact)</a>
<a class="sourceLine" id="cb8-12" data-line-number="12">##           BRCA1     BRCA2      NAT2</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">## BRCA1 1.0000000 1.0000000 0.1574879</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">## BRCA2 1.0000000 1.0000000 0.0785169</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">## NAT2  0.1574879 0.0785169 1.0000000</a></code></pre></div>
<p>Note that for the same genes each database or list provided has different annotations, which result on different similarity scores. In this example BRCA1 has 3 and 14 pathways in KEGG and Reactome respectively and BRCA2 has 1 and 38 pathways in KEGG and Reactome respectively which results on different scores.</p>
</div>
<div id="gene-cluster-similarities" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-cluster-similarities" class="anchor"></a>Gene cluster similarities</h2>
<p>There are two methods:</p>
<ul>
<li>Combining all the pathways for each cluster and compare between them.</li>
<li>Calculate the similarity between genes of a cluster and the other cluster.</li>
</ul>
<div id="clusterSim" class="section level3">
<h3 class="hasAnchor">
<a href="#clusterSim" class="anchor"></a>By pathways</h3>
<p>As explained, in this method all the pathways of a cluster are compared with all the pathways of the other cluster. If a method to combine pathways similarities is not provided, all pathway similarities are returned:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/clusterSim.html">clusterSim</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"672"</span>, <span class="st">"675"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span>), genesKegg)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">## [1] 0.04210526</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="../reference/clusterSim.html">clusterSim</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"672"</span>, <span class="st">"675"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span>), genesKegg, <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">##            00230       01100       05340 00232 00983</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">## 04120 0.00000000 0.000000000 0.011764706     0     0</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">## 03440 0.04210526 0.006908463 0.000000000     0     0</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">## 05200 0.00000000 0.008241758 0.005540166     0     0</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">## 05212 0.00000000 0.001666667 0.019047619     0     0</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">clusters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">cluster1 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"672"</span>, <span class="st">"675"</span>),</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">                 <span class="dt">cluster2 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span>),</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">                 <span class="dt">cluster3 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"18"</span>, <span class="st">"10"</span>, <span class="st">"83"</span>))</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="kw"><a href="../reference/mclusterSim.html">mclusterSim</a></span>(clusters, genesKegg, <span class="st">"rcmax.avg"</span>)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">##            cluster1   cluster2   cluster3</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">## cluster1 1.00000000 0.01587957 0.00256157</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">## cluster2 0.01587957 1.00000000 0.56412591</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">## cluster3 0.00256157 0.56412591 1.00000000</a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="kw"><a href="../reference/mclusterSim.html">mclusterSim</a></span>(clusters, genesKegg, <span class="st">"max"</span>)</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">##             cluster1   cluster2    cluster3</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">## cluster1 1.000000000 0.04210526 0.008241758</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">## cluster2 0.042105263 1.00000000 1.000000000</a>
<a class="sourceLine" id="cb9-22" data-line-number="22">## cluster3 0.008241758 1.00000000 1.000000000</a></code></pre></div>
</div>
<div id="clusterGeneSim" class="section level3">
<h3 class="hasAnchor">
<a href="#clusterGeneSim" class="anchor"></a>By genes</h3>
<p>In this method first the similarities between each gene is calculated, then the similarity between each group of genes is calculated. Requiring two methods to combine values, the first one to combine pathways similarities and the second one to combine genes similarities. If only one is provided it returns the matrix of similarities of the genes of each cluster:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/clusterGeneSim.html">clusterGeneSim</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"672"</span>, <span class="st">"675"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span>), genesKegg)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">## [1] 0.02605425</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="../reference/clusterGeneSim.html">clusterGeneSim</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"672"</span>, <span class="st">"675"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span>), genesKegg, <span class="st">"max"</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">##            100          10  1</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">## 672 0.01176471 0.000000000 NA</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">## 675 0.04210526 0.008241758 NA</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="kw"><a href="../reference/mclusterGeneSim.html">mclusterGeneSim</a></span>(clusters, genesKegg, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"max"</span>, <span class="st">"rcmax.avg"</span>))</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">##             cluster1   cluster2    cluster3</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">## cluster1 1.000000000 0.02605425 0.006181319</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">## cluster2 0.026054248 1.00000000 1.000000000</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">## cluster3 0.006181319 1.00000000 1.000000000</a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="kw"><a href="../reference/mclusterGeneSim.html">mclusterGeneSim</a></span>(clusters, genesKegg, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"max"</span>, <span class="st">"max"</span>))</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">##             cluster1   cluster2    cluster3</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">## cluster1 1.000000000 0.04210526 0.008241758</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">## cluster2 0.042105263 1.00000000 1.000000000</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">## cluster3 0.008241758 1.00000000 1.000000000</a></code></pre></div>
<p>Note the differences between <code>mclusterGeneSim</code> and <code>mclusterSim</code> in the similarity values of the clusters. If we set <code>method = c("max", "max")</code> in <code>mclusterGeneSim</code> then the similarity between the clusters is the same as <code>clusterSim</code>.</p>
</div>
</div>
<div id="D2J" class="section level2">
<h2 class="hasAnchor">
<a href="#D2J" class="anchor"></a>Converting similarities</h2>
<p>If needed, Jaccard similarity can be calculated from Dice similarity using <code>D2J</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/conversions.html">D2J</a></span>(sim)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">##               R-HSA-532668 R-HSA-5654726 R-HSA-5545483 R-HSA-1643713</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">## R-HSA-532668    1.00000000    0.06250000             0    0.07142857</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">## R-HSA-5654726   0.06250000    1.00000000             0    0.11538462</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">## R-HSA-5545483   0.00000000    0.00000000             1    0.00000000</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">## R-HSA-1643713   0.07142857    0.11538462             0    1.00000000</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">## R-HSA-5693571   0.00000000    0.00000000             0    0.00000000</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">## R-HSA-68884     0.00000000    0.00000000             0    0.00000000</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">## R-HSA-9013973   0.09302326    0.09756098             0    0.12121212</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">## R-HSA-6791462   0.00000000    0.00000000             0    0.00000000</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">## R-HSA-6803529   0.00000000    0.00000000             0    0.00000000</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">## R-HSA-379398    0.00000000    0.00000000             0    0.00000000</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">##               R-HSA-5693571 R-HSA-68884 R-HSA-9013973 R-HSA-6791462</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">## R-HSA-532668              0           0    0.09302326             0</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">## R-HSA-5654726             0           0    0.09756098             0</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">## R-HSA-5545483             0           0    0.00000000             0</a>
<a class="sourceLine" id="cb11-17" data-line-number="17">## R-HSA-1643713             0           0    0.12121212             0</a>
<a class="sourceLine" id="cb11-18" data-line-number="18">## R-HSA-5693571             1           0    0.00000000             0</a>
<a class="sourceLine" id="cb11-19" data-line-number="19">## R-HSA-68884               0           1    0.00000000             0</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">## R-HSA-9013973             0           0    1.00000000             0</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">## R-HSA-6791462             0           0    0.00000000             1</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">## R-HSA-6803529             0           0    0.00000000             0</a>
<a class="sourceLine" id="cb11-23" data-line-number="23">## R-HSA-379398              0           0    0.00000000             0</a>
<a class="sourceLine" id="cb11-24" data-line-number="24">##               R-HSA-6803529 R-HSA-379398</a>
<a class="sourceLine" id="cb11-25" data-line-number="25">## R-HSA-532668              0            0</a>
<a class="sourceLine" id="cb11-26" data-line-number="26">## R-HSA-5654726             0            0</a>
<a class="sourceLine" id="cb11-27" data-line-number="27">## R-HSA-5545483             0            0</a>
<a class="sourceLine" id="cb11-28" data-line-number="28">## R-HSA-1643713             0            0</a>
<a class="sourceLine" id="cb11-29" data-line-number="29">## R-HSA-5693571             0            0</a>
<a class="sourceLine" id="cb11-30" data-line-number="30">## R-HSA-68884               0            0</a>
<a class="sourceLine" id="cb11-31" data-line-number="31">## R-HSA-9013973             0            0</a>
<a class="sourceLine" id="cb11-32" data-line-number="32">## R-HSA-6791462             0            0</a>
<a class="sourceLine" id="cb11-33" data-line-number="33">## R-HSA-6803529             1            0</a>
<a class="sourceLine" id="cb11-34" data-line-number="34">## R-HSA-379398              0            1</a></code></pre></div>
<p>Also if one has a Jaccard similarity and wants a Dice similarity, can use the <code>J2D</code> function.</p>
</div>
</div>
<div id="high-volumes-of-gene-similarities" class="section level1">
<h1 class="hasAnchor">
<a href="#high-volumes-of-gene-similarities" class="anchor"></a>High volumes of gene similarities</h1>
<p>We can compute the whole similarity of genes in KEGG or Reactome by using :</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">## Omit those genes without a pathway</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">nas &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(genesKegg, <span class="cf">function</span>(y){<span class="kw"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(y)) <span class="op">|</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(y)})</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">genesKegg2 &lt;-<span class="st"> </span>genesKegg[<span class="op">!</span>nas]</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mgeneSim.html">mgeneSim</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(genesKegg2), genesKegg2, <span class="dt">method  =</span> <span class="st">"max"</span>)</a></code></pre></div>
<p>It takes around 5 hours in one core but it requires high memory available.</p>
<p>If one doesn’t have such a memory available can compute the similarities by pieces, and then fit it in another matrix with:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/AintoB.html">AintoB</a></span>(m, B)</a></code></pre></div>
<p>Usually B is a matrix of size <code><a href="https://rdrr.io/r/base/length.html">length(genes)</a></code>, see <code><a href="../reference/AintoB.html">?AintoB</a></code>.</p>
</div>
<div id="an-example-of-usage" class="section level1">
<h1 class="hasAnchor">
<a href="#an-example-of-usage" class="anchor"></a>An example of usage</h1>
<p>In this example I show how to use BioCor to analyse a list of genes by functionality. With a list of genes we are going to see how similar are those genes:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">genes.id &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"10"</span>, <span class="st">"15"</span>, <span class="st">"16"</span>, <span class="st">"18"</span>, <span class="st">"2"</span>, <span class="st">"9"</span>, <span class="st">"52"</span>, <span class="st">"3855"</span>, <span class="st">"3880"</span>, <span class="st">"644"</span>, </a>
<a class="sourceLine" id="cb14-2" data-line-number="2">              <span class="st">"81327"</span>, <span class="st">"9128"</span>, <span class="st">"2073"</span>, <span class="st">"2893"</span>, <span class="st">"5142"</span>, <span class="st">"60"</span>, <span class="st">"210"</span>, <span class="st">"81"</span>, </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">              <span class="st">"1352"</span>, <span class="st">"88"</span>, <span class="st">"672"</span>, <span class="st">"675"</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">genes.id &lt;-<span class="st"> </span><span class="kw">mapIds</span>(org.Hs.eg.db, <span class="dt">keys =</span> genes.id, <span class="dt">keytype =</span> <span class="st">"ENTREZID"</span>, </a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                   <span class="dt">column =</span> <span class="st">"SYMBOL"</span>)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">## 'select()' returned 1:1 mapping between keys and columns</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(genes.id)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(genes) &lt;-<span class="st"> </span>genes.id</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">react &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mgeneSim.html">mgeneSim</a></span>(genes, genesReact)</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">## Warning in mgeneSim(genes, genesReact): Some genes are not in the list</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">## provided.</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">## We remove genes which are not in list (hence the warning):</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">nan &lt;-<span class="st"> </span>genes <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(genesReact)</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">react &lt;-<span class="st"> </span>react[nan, nan]</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">hc &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>react))</a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(hc, <span class="dt">main =</span> <span class="st">"Similarities between genes"</span>)</a></code></pre></div>
<div class="figure">
<img src="BioCor_1_basics_files/figure-html/hclust1-1.png" alt="Gene clustering by similarities" width="700"><p class="caption">
Gene clustering by similarities
</p>
</div>
<p>Now we can see the relationship between the genes. We can group them for a cluster analysis to visualize the relationship between the clusters:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">mycl &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span>(hc, <span class="dt">h =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">clusters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/split.html">split</a></span>(genes[nan], <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(mycl))</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co"># Removing clusters of just one gene</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">(clusters &lt;-<span class="st"> </span>clusters[<span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(clusters) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">## $`1`</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">##   NAT2  AANAT   NAT1  BLVRA   ALAD  COX10 </a>
<a class="sourceLine" id="cb15-7" data-line-number="7">##   "10"   "15"    "9"  "644"  "210" "1352" </a>
<a class="sourceLine" id="cb15-8" data-line-number="8">## </a>
<a class="sourceLine" id="cb15-9" data-line-number="9">## $`2`</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">##  AARS  ACTB BRCA1 </a>
<a class="sourceLine" id="cb15-11" data-line-number="11">##  "16"  "60" "672" </a>
<a class="sourceLine" id="cb15-12" data-line-number="12">## </a>
<a class="sourceLine" id="cb15-13" data-line-number="13">## $`3`</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">##   ABAT  GRIA4  ACTN2 </a>
<a class="sourceLine" id="cb15-15" data-line-number="15">##   "18" "2893"   "88" </a>
<a class="sourceLine" id="cb15-16" data-line-number="16">## </a>
<a class="sourceLine" id="cb15-17" data-line-number="17">## $`4`</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">##     A2M  OR4A16   PDE4B </a>
<a class="sourceLine" id="cb15-19" data-line-number="19">##     "2" "81327"  "5142" </a>
<a class="sourceLine" id="cb15-20" data-line-number="20">## </a>
<a class="sourceLine" id="cb15-21" data-line-number="21">## $`5`</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">##   KRT7  KRT19 </a>
<a class="sourceLine" id="cb15-23" data-line-number="23">## "3855" "3880" </a>
<a class="sourceLine" id="cb15-24" data-line-number="24">## </a>
<a class="sourceLine" id="cb15-25" data-line-number="25">## $`7`</a>
<a class="sourceLine" id="cb15-26" data-line-number="26">##  ERCC5  BRCA2 </a>
<a class="sourceLine" id="cb15-27" data-line-number="27">## "2073"  "675"</a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(clusters) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"cluster"</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(clusters))</a>
<a class="sourceLine" id="cb15-29" data-line-number="29">## Remember we can use two methods to compare clusters</a>
<a class="sourceLine" id="cb15-30" data-line-number="30">sim_clus1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mclusterSim.html">mclusterSim</a></span>(clusters, genesReact)</a>
<a class="sourceLine" id="cb15-31" data-line-number="31"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>sim_clus1)), </a>
<a class="sourceLine" id="cb15-32" data-line-number="32">     <span class="dt">main =</span> <span class="st">"Similarities between clusters by pathways"</span>)</a></code></pre></div>
<div class="figure">
<img src="BioCor_1_basics_files/figure-html/hclust3-1.png" alt="Clustering using clusterSim" width="700"><p class="caption">
Clustering using clusterSim
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">sim_clus2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mclusterGeneSim.html">mclusterGeneSim</a></span>(clusters, genesReact)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>sim_clus2)), </a>
<a class="sourceLine" id="cb16-3" data-line-number="3">     <span class="dt">main =</span><span class="st">"Similarities between clusters by genes"</span>)</a></code></pre></div>
<div class="figure">
<img src="BioCor_1_basics_files/figure-html/hclust3b-1.png" alt="Clustering using clusterGeneSim" width="700"><p class="caption">
Clustering using clusterGeneSim
</p>
</div>
<p>Each method results in a different dendrogram as we can see on Figure @ref(fig:hclust3) compared to Figure @ref(fig:hclust3b).</p>
</div>
<div id="comparing-with-gosemsim" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-with-gosemsim" class="anchor"></a>Comparing with GOSemSim</h1>
<p>In this section I will compare the functional similarity of BioCor with the closely related package <em><a href="https://bioconductor.org/packages/3.10/GOSemSim">GOSemSim</a></em>. The genes and gene clusters used were extracted from GOSemSim’s vignette, we only change the ontology, instead of the molecular function, the biological process will be used:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"GOSemSim"</span>))</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">hsGO &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/GOSemSim/man/godata.html">godata</a></span>(<span class="st">'org.Hs.eg.db'</span>, <span class="dt">ont =</span> <span class="st">"BP"</span>, <span class="dt">computeIC =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">## preparing gene to GO mapping data...</a></code></pre></div>
<p>I will compare the functions geneSim from section <a href="http://bioconductor.org/packages/release/bioc/vignettes/GOSemSim/inst/doc/GOSemSim.html#genesim-and-mgenesim">geneSim and mgeneSim from GOSemSim</a> with both data sets from KEGG and Reactome:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">goSemSim &lt;-<span class="st"> </span>GOSemSim<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/GOSemSim/man/geneSim.html">geneSim</a></span>(<span class="st">"241"</span>, <span class="st">"251"</span>, <span class="dt">semData =</span> hsGO, </a>
<a class="sourceLine" id="cb18-2" data-line-number="2">                              <span class="dt">measure =</span> <span class="st">"Wang"</span>, <span class="dt">combine=</span><span class="st">"BMA"</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co"># In case it is null</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">sim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(goSemSim), <span class="dv">0</span>, <span class="kw"><a href="https://rdrr.io/r/base/Extract.html">getElement</a></span>(goSemSim, <span class="st">"geneSim"</span>))</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">BioCor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BioCor/man/geneSim.html">geneSim</a></span>(<span class="st">"241"</span>, <span class="st">"251"</span>, genesReact, <span class="st">"BMA"</span>) <span class="op">-</span><span class="st"> </span>sim</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">## [1] 0.04334621</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"></a>
<a class="sourceLine" id="cb18-8" data-line-number="8">genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"835"</span>, <span class="st">"5261"</span>,<span class="st">"241"</span>, <span class="st">"994"</span>)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">goSemSim &lt;-<span class="st"> </span>GOSemSim<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/GOSemSim/man/mgeneSim.html">mgeneSim</a></span>(genes, <span class="dt">semData =</span> hsGO, </a>
<a class="sourceLine" id="cb18-10" data-line-number="10">                   <span class="dt">measure =</span> <span class="st">"Wang"</span>, <span class="dt">combine =</span> <span class="st">"BMA"</span>,</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">                   <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">drop =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb18-12" data-line-number="12">BioCor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BioCor/man/mgeneSim.html">mgeneSim</a></span>(genes, genesReact, <span class="st">"BMA"</span>, <span class="dt">round =</span> <span class="ot">TRUE</span>) <span class="op">-</span><span class="st"> </span>goSemSim</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">##         835   5261    241    994</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">## 835   0.000 -0.099 -0.135 -0.251</a>
<a class="sourceLine" id="cb18-15" data-line-number="15">## 5261 -0.099  0.000 -0.004 -0.279</a>
<a class="sourceLine" id="cb18-16" data-line-number="16">## 241  -0.135 -0.004  0.000 -0.185</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">## 994  -0.251 -0.279 -0.185  0.000</a></code></pre></div>
<p>We can observe there is more similarity according to the gene ontology than according to the pathways. See FAQ <a href="#conflict">question 8</a> about the use of <code>BioCor::</code> and <code>GOSemSim::</code>.</p>
<p>If named characters are passed they are used to name the resulting matrix:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CDC45"</span>, <span class="st">"MCM10"</span>, <span class="st">"CDC20"</span>, <span class="st">"NMU"</span>, <span class="st">"MMP1"</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">genese &lt;-<span class="st"> </span><span class="kw">mapIds</span>(org.Hs.eg.db, <span class="dt">keys =</span> genes, <span class="dt">column =</span> <span class="st">"ENTREZID"</span>, </a>
<a class="sourceLine" id="cb19-3" data-line-number="3">                 <span class="dt">keytype =</span> <span class="st">"SYMBOL"</span>)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">## 'select()' returned 1:1 mapping between keys and columns</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">BioCor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BioCor/man/mgeneSim.html">mgeneSim</a></span>(genese, genesReact, <span class="st">"BMA"</span>)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">##            CDC45      MCM10     CDC20        NMU       MMP1</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">## CDC45 1.00000000 0.91880433 0.5137832 0.04674333 0.09495772</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">## MCM10 0.91880433 1.00000000 0.5254539 0.05422998 0.09973228</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">## CDC20 0.51378321 0.52545394 1.0000000 0.15883755 0.22742101</a>
<a class="sourceLine" id="cb19-10" data-line-number="10">## NMU   0.04674333 0.05422998 0.1588375 1.00000000 0.10155482</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">## MMP1  0.09495772 0.09973228 0.2274210 0.10155482 1.00000000</a></code></pre></div>
<p>We can further compare the cluster similarities from the <a href="http://bioconductor.org/packages/release/bioc/vignettes/GOSemSim/inst/doc/GOSemSim.html#clustersim-and-mclustersim">next section of the vignette</a>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">gs1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"835"</span>, <span class="st">"5261"</span>,<span class="st">"241"</span>, <span class="st">"994"</span>, <span class="st">"514"</span>, <span class="st">"533"</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">gs2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"578"</span>,<span class="st">"582"</span>, <span class="st">"400"</span>, <span class="st">"409"</span>, <span class="st">"411"</span>)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">BioCor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BioCor/man/clusterSim.html">clusterSim</a></span>(gs1, gs2, genesReact, <span class="st">"BMA"</span>) <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">    </span>GOSemSim<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/GOSemSim/man/clusterSim.html">clusterSim</a></span>(gs1, gs2, hsGO, <span class="dt">measure =</span> <span class="st">"Wang"</span>, <span class="dt">combine =</span> <span class="st">"BMA"</span>)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">## [1] -0.1483028</a>
<a class="sourceLine" id="cb20-6" data-line-number="6"></a>
<a class="sourceLine" id="cb20-7" data-line-number="7">x &lt;-<span class="st"> </span>org.Hs.egGO</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">hsEG &lt;-<span class="st"> </span><span class="kw">mappedkeys</span>(x)</a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb20-10" data-line-number="10">(clusters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">a=</span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(hsEG, <span class="dv">20</span>), <span class="dt">b=</span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(hsEG, <span class="dv">20</span>), <span class="dt">c=</span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(hsEG, <span class="dv">20</span>)))</a>
<a class="sourceLine" id="cb20-11" data-line-number="11">## $a</a>
<a class="sourceLine" id="cb20-12" data-line-number="12">##  [1] "3782"   "390667" "151449" "115752" "167465" "5706"   "23536" </a>
<a class="sourceLine" id="cb20-13" data-line-number="13">##  [8] "29960"  "8473"   "1453"   "6253"   "4850"   "5358"   "6788"  </a>
<a class="sourceLine" id="cb20-14" data-line-number="14">## [15] "148327" "284433" "414196" "51175"  "6097"   "768217"</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">## </a>
<a class="sourceLine" id="cb20-16" data-line-number="16">## $b</a>
<a class="sourceLine" id="cb20-17" data-line-number="17">##  [1] "11261"     "9097"      "727676"    "80183"     "5010"     </a>
<a class="sourceLine" id="cb20-18" data-line-number="18">##  [6] "51704"     "4713"      "80700"     "9440"      "151987"   </a>
<a class="sourceLine" id="cb20-19" data-line-number="19">## [11] "90011"     "388630"    "219699"    "6727"      "4038"     </a>
<a class="sourceLine" id="cb20-20" data-line-number="20">## [16] "8811"      "55204"     "28516"     "100191063" "646962"   </a>
<a class="sourceLine" id="cb20-21" data-line-number="21">## </a>
<a class="sourceLine" id="cb20-22" data-line-number="22">## $c</a>
<a class="sourceLine" id="cb20-23" data-line-number="23">##  [1] "8895"      "406954"    "6920"      "100033445" "7480"     </a>
<a class="sourceLine" id="cb20-24" data-line-number="24">##  [6] "345930"    "341880"    "8434"      "55544"     "389791"   </a>
<a class="sourceLine" id="cb20-25" data-line-number="25">## [11] "29956"     "56648"     "407051"    "51802"     "54084"    </a>
<a class="sourceLine" id="cb20-26" data-line-number="26">## [16] "5927"      "219854"    "284257"    "1036"      "29072"</a>
<a class="sourceLine" id="cb20-27" data-line-number="27">BioCor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BioCor/man/mclusterSim.html">mclusterSim</a></span>(clusters, genesReact, <span class="st">"BMA"</span>) <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-28" data-line-number="28"><span class="st">    </span>GOSemSim<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/GOSemSim/man/mclusterSim.html">mclusterSim</a></span>(clusters, hsGO, <span class="dt">measure =</span> <span class="st">"Wang"</span>, <span class="dt">combine =</span> <span class="st">"BMA"</span>)</a>
<a class="sourceLine" id="cb20-29" data-line-number="29">## Warning in BioCor::mclusterSim(clusters, genesReact, "BMA"): Some genes are</a>
<a class="sourceLine" id="cb20-30" data-line-number="30">## not in the list provided.</a>
<a class="sourceLine" id="cb20-31" data-line-number="31">##            a          b          c</a>
<a class="sourceLine" id="cb20-32" data-line-number="32">## a 0.00000000 0.04737658 0.02514048</a>
<a class="sourceLine" id="cb20-33" data-line-number="33">## b 0.04737658 0.00000000 0.15745681</a>
<a class="sourceLine" id="cb20-34" data-line-number="34">## c 0.02514048 0.15745681 0.00000000</a></code></pre></div>
</div>
<div id="wgcna-and-biocor" class="section level1">
<h1 class="hasAnchor">
<a href="#wgcna-and-biocor" class="anchor"></a>WGCNA and BioCor</h1>
<p><em><a href="https://CRAN.R-project.org/package=WGCNA">WGCNA</a></em> uses the correlation of the expression data of several samples to cluster genes. Sometimes, from a biological point of view the interpretation of the resulting modules is difficult, even more when some groups of genes end up not having an enrichment in previously described functions. BioCor was originally thought to be used to overcome this problem: to help clustering genes, not only by correlation but also by functionality.</p>
<p>In order to have groups functionally related, functional similarities can enhance the clustering of genes when combined with experimental correlations. The resulting groups will reflect, not only the correlation of the expression provided, but also the functionality known of those genes.</p>
<p>We propose the following steps:</p>
<ol style="list-style-type: decimal">
<li>Calculate the similarities for the expression data</li>
<li>Calculate the similarities of the genes in the expression</li>
<li>Combine the similarities</li>
<li>Calculate the adjacency</li>
<li>Identify modules with hierarchical clustering</li>
</ol>
<p>Here we provide an example on how to use BioCor with WGCNA:</p>
<p><code>sim</code> is a list where each element is a matrix of similarities between genes Our normalized expression is in the <code>expr</code> variable, a matrix where the samples are in the rows and genes in the columns.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">expr.sim &lt;-<span class="st"> </span>WGCNA<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/WGCNA/man/cor.html">cor</a></span>(expr) <span class="co"># or bicor</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">## Combine the similarities</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">similarity &lt;-<span class="st"> </span><span class="kw"><a href="../reference/similarities.html">similarities</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">exp =</span> expr.sim), sim), mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"></a>
<a class="sourceLine" id="cb21-6" data-line-number="6">## Choose the softThreshold</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">pSFT &lt;-<span class="st"> </span><span class="kw">pickSoftThreshold.fromSimilarity</span>(similarity)</a>
<a class="sourceLine" id="cb21-8" data-line-number="8"></a>
<a class="sourceLine" id="cb21-9" data-line-number="9">## Or any other function we want</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">adjacency &lt;-<span class="st"> </span><span class="kw">adjacency.fromSimilarity</span>(similarity, <span class="dt">power =</span> pSFT<span class="op">$</span>powerEstimate)</a>
<a class="sourceLine" id="cb21-11" data-line-number="11"></a>
<a class="sourceLine" id="cb21-12" data-line-number="12">## Once we have the similarities we can calculate the TOM with TOM</a>
<a class="sourceLine" id="cb21-13" data-line-number="13">TOM &lt;-<span class="st"> </span><span class="kw">TOMsimilarity</span>(adjacency) ## Requires adjacencies despite its name </a>
<a class="sourceLine" id="cb21-14" data-line-number="14">dissTOM &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>TOM</a>
<a class="sourceLine" id="cb21-15" data-line-number="15">geneTree &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span>(dissTOM), <span class="dt">method =</span> <span class="st">"average"</span>)</a>
<a class="sourceLine" id="cb21-16" data-line-number="16">## We can use a clustering tool to group the genes</a>
<a class="sourceLine" id="cb21-17" data-line-number="17">dynamicMods &lt;-<span class="st"> </span><span class="kw">cutreeHybrid</span>(<span class="dt">dendro =</span> geneTree, <span class="dt">distM =</span> dissTOM,</a>
<a class="sourceLine" id="cb21-18" data-line-number="18">                            <span class="dt">deepSplit =</span> <span class="dv">2</span>, <span class="dt">pamRespectsDendro =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb21-19" data-line-number="19">                            <span class="dt">minClusterSize =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb21-20" data-line-number="20">moduleColors &lt;-<span class="st"> </span><span class="kw">labels2colors</span>(dynamicMods<span class="op">$</span>labels)</a></code></pre></div>
<p>Once the modules are identified using the functional similarities of this package and the gene correlations, one can continue with the workflow of WGCNA.</p>
<p>An important aspect in this process is deciding how to combine the similarities and the expression data: - If the functional similarities play a huge role, we will end up having only those genes closely related to the same functions. - If the functional similarities play a low role, it will be similarly to only use WGCNA, and the genes won’t be functionally related.</p>
<p>For these reasons it is better to use weights between <code>0.5</code> and <code>1</code> for expression if you use <code>weighted.sum</code> or similar functions.</p>
<p>There are several things to take into account when choosing a way to combine: - The size of the gray or 0 modules (those who don’t show a specific pattern) - The number and size of the modules created. - The way the similarities are combined</p>
<p>Violin plots may help to view the differences in size and distribution of the modules across different methods of combining the similarities.</p>
</div>
<div id="faq" class="section level1">
<h1 class="hasAnchor">
<a href="#faq" class="anchor"></a>FAQ</h1>
<div id="FAQ1" class="section level2">
<h2 class="hasAnchor">
<a href="#FAQ1" class="anchor"></a>How is defined the pathway similarity?</h2>
<p>BioCor uses the <a href="https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient">Sørensen–Dice index</a>: The dice similarity is the double of the genes shared by the pathways divided by the number of genes in each pathway.</p>
<p>We can calculate the similarity between two pathways (<span class="math inline">\(x\)</span>, <span class="math inline">\(w\)</span>) with:</p>
<p><span class="math display">\[Dice(x, w) = \frac{2 |x \cap w|}{|x| + |w|}\]</span></p>
<p>This is implemented in the <code>diceSim</code> function, which results is similar to Jaccard index:</p>
<p><span class="math display">\[Jaccard(x, w) = \frac{|x \cap w|}{|x \cup w|}\]</span></p>
<p>Both Jaccard index and dice index are between 0 and 1 (<span class="math inline">\([0, 1]\)</span>). To calculate the Jaccard index from the <code>diceSim</code> use the <code>D2J</code> function.</p>
</div>
<div id="why-does-biocor-use-the-dice-coefficient-and-not-the-jaccard" class="section level2">
<h2 class="hasAnchor">
<a href="#why-does-biocor-use-the-dice-coefficient-and-not-the-jaccard" class="anchor"></a>Why does BioCor use the dice coefficient and not the Jaccard ?</h2>
<p>We consider Dice coefficient better than Jaccard because it has higher values for the same comparisons, which reflects that including a gene in a pathway is not easily done.</p>
</div>
<div id="how-does-biocor-combine-similarities-between-several-pathways-of-two-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#how-does-biocor-combine-similarities-between-several-pathways-of-two-genes" class="anchor"></a>How does BioCor combine similarities between several pathways of two genes?</h2>
<p>Although the recommend method is the “max” method, (set as default), there are implemented other methods in <code>combineScores</code> of the <em><a href="https://bioconductor.org/packages/3.10/GOSemSim">GOSemSim</a></em> package which I borrowed<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="why-do-you-recommend-using-the-max-method-to-combine-similarities-scores-for-pathways" class="section level2">
<h2 class="hasAnchor">
<a href="#why-do-you-recommend-using-the-max-method-to-combine-similarities-scores-for-pathways" class="anchor"></a>Why do you recommend using the max method to combine similarities scores for pathways?</h2>
<p>The purpose of combining the scores is usually to find the relationships between genes through their pathways. The higher the similarity is between two pathway of two genes, the higher functionality do the genes share, even if those genes have other non-related functions.</p>
</div>
<div id="how-to-detect-which-functional-relationship-is-more-important-between-two-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-detect-which-functional-relationship-is-more-important-between-two-genes" class="anchor"></a>How to detect which functional relationship is more important between two genes?</h2>
<p>If two genes are involved in the same pathways usually they have (to some extent, maybe indirect) interactions. To detect which relationship is more important between two genes one could measure other similarities scores and check the stoichiometry of the pathways and measure the expression changes and correlation between them or use dynamic simulations of the pathways.</p>
</div>
<div id="how-to-detect-with-which-genes-is-my-gene-of-interest-related" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-detect-with-which-genes-is-my-gene-of-interest-related" class="anchor"></a>How to detect with which genes is my gene of interest related?</h2>
<p>You can measure the <a href="#geneSim">gene similarity</a> between those genes and also measure the expression correlation of your gene of interest with other genes.</p>
</div>
<div id="why-isnt-available-a-method-for-calculating-go-similarities" class="section level2">
<h2 class="hasAnchor">
<a href="#why-isnt-available-a-method-for-calculating-go-similarities" class="anchor"></a>Why isn’t available a method for calculating GO similarities?</h2>
<p>This is covered by the <em><a href="https://bioconductor.org/packages/3.10/GOSemSim">GOSemSim</a></em> package, you can use it to produce a similarity matrix (i.e. use <code>mgeneSim</code>). You can parallelize it with <code>foreach</code> package or <code>BiocParallel</code> if your list of genes is big.</p>
</div>
<div id="conflict" class="section level2">
<h2 class="hasAnchor">
<a href="#conflict" class="anchor"></a>I get an error! How do I solve this?</h2>
<p>If the error is like this:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">Error <span class="cf">in</span> <span class="kw">FUN</span>(X[[i]], ...) <span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span>trying to get slot <span class="st">"geneAnno"</span> from an object of a basic <span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span> (<span class="st">"list"</span>) with no slots</a></code></pre></div>
<p>And you have loaded the <code>GOSemSim</code> library, R is calling the GOSemSim function of the same name. Use <code>BioCor::</code> to call the function from <code>BioCor</code> (f.ex: <code><a href="../reference/geneSim.html">BioCor::geneSim</a></code>)</p>
<p>If the error is not previously described in the <a href="https:support.bioconductor.org">support forum</a>, post a question there.</p>
<p>My apologies if you found a bug or an inconsistency between what <code>BioCor</code> should do and what it actually does. Once you checked that it is a bug, please let me know at the <em><a href="https://github.com/llrs/BioCor/issues">issues</a></em> page of Github.</p>
</div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">## R version 3.6.1 (2017-01-27)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">## Platform: x86_64-pc-linux-gnu (64-bit)</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">## Running under: Ubuntu 16.04.6 LTS</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">## </a>
<a class="sourceLine" id="cb23-6" data-line-number="6">## Matrix products: default</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">## BLAS:   /home/travis/R-bin/lib/R/lib/libRblas.so</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">## LAPACK: /home/travis/R-bin/lib/R/lib/libRlapack.so</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">## </a>
<a class="sourceLine" id="cb23-10" data-line-number="10">## locale:</a>
<a class="sourceLine" id="cb23-11" data-line-number="11">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </a>
<a class="sourceLine" id="cb23-12" data-line-number="12">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </a>
<a class="sourceLine" id="cb23-13" data-line-number="13">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </a>
<a class="sourceLine" id="cb23-14" data-line-number="14">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </a>
<a class="sourceLine" id="cb23-15" data-line-number="15">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </a>
<a class="sourceLine" id="cb23-16" data-line-number="16">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </a>
<a class="sourceLine" id="cb23-17" data-line-number="17">## </a>
<a class="sourceLine" id="cb23-18" data-line-number="18">## attached base packages:</a>
<a class="sourceLine" id="cb23-19" data-line-number="19">## [1] parallel  stats4    stats     graphics  grDevices utils     datasets </a>
<a class="sourceLine" id="cb23-20" data-line-number="20">## [8] methods   base     </a>
<a class="sourceLine" id="cb23-21" data-line-number="21">## </a>
<a class="sourceLine" id="cb23-22" data-line-number="22">## other attached packages:</a>
<a class="sourceLine" id="cb23-23" data-line-number="23">##  [1] GOSemSim_2.11.0      reactome.db_1.68.0   org.Hs.eg.db_3.8.2  </a>
<a class="sourceLine" id="cb23-24" data-line-number="24">##  [4] AnnotationDbi_1.47.1 IRanges_2.19.16      S4Vectors_0.23.25   </a>
<a class="sourceLine" id="cb23-25" data-line-number="25">##  [7] Biobase_2.45.1       BiocGenerics_0.31.6  BioCor_1.9.2        </a>
<a class="sourceLine" id="cb23-26" data-line-number="26">## [10] BiocStyle_2.13.2    </a>
<a class="sourceLine" id="cb23-27" data-line-number="27">## </a>
<a class="sourceLine" id="cb23-28" data-line-number="28">## loaded via a namespace (and not attached):</a>
<a class="sourceLine" id="cb23-29" data-line-number="29">##  [1] xfun_0.10           lattice_0.20-38     vctrs_0.2.0        </a>
<a class="sourceLine" id="cb23-30" data-line-number="30">##  [4] htmltools_0.3.6     yaml_2.2.0          blob_1.2.0         </a>
<a class="sourceLine" id="cb23-31" data-line-number="31">##  [7] XML_3.98-1.20       rlang_0.4.0         pkgdown_1.4.1      </a>
<a class="sourceLine" id="cb23-32" data-line-number="32">## [10] pillar_1.4.2        DBI_1.0.0           BiocParallel_1.19.3</a>
<a class="sourceLine" id="cb23-33" data-line-number="33">## [13] bit64_0.9-7         stringr_1.4.0       memoise_1.1.0      </a>
<a class="sourceLine" id="cb23-34" data-line-number="34">## [16] evaluate_0.14       knitr_1.25          highr_0.8          </a>
<a class="sourceLine" id="cb23-35" data-line-number="35">## [19] GSEABase_1.47.0     Rcpp_1.0.2          xtable_1.8-4       </a>
<a class="sourceLine" id="cb23-36" data-line-number="36">## [22] backports_1.1.5     BiocManager_1.30.4  desc_1.2.0         </a>
<a class="sourceLine" id="cb23-37" data-line-number="37">## [25] graph_1.63.0        annotate_1.63.0     fs_1.3.1           </a>
<a class="sourceLine" id="cb23-38" data-line-number="38">## [28] bit_1.1-14          digest_0.6.21       stringi_1.4.3      </a>
<a class="sourceLine" id="cb23-39" data-line-number="39">## [31] bookdown_0.14       rprojroot_1.3-2     grid_3.6.1         </a>
<a class="sourceLine" id="cb23-40" data-line-number="40">## [34] tools_3.6.1         bitops_1.0-6        magrittr_1.5       </a>
<a class="sourceLine" id="cb23-41" data-line-number="41">## [37] RCurl_1.95-4.12     RSQLite_2.1.2       tibble_2.1.3       </a>
<a class="sourceLine" id="cb23-42" data-line-number="42">## [40] GO.db_3.8.2         crayon_1.3.4        pkgconfig_2.0.3    </a>
<a class="sourceLine" id="cb23-43" data-line-number="43">## [43] zeallot_0.1.0       MASS_7.3-51.4       Matrix_1.2-17      </a>
<a class="sourceLine" id="cb23-44" data-line-number="44">## [46] assertthat_0.2.1    rmarkdown_1.16      R6_2.4.0           </a>
<a class="sourceLine" id="cb23-45" data-line-number="45">## [49] compiler_3.6.1</a></code></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>See the <a href="#combining">Combining values section</a> and the help page of <code>combineScores</code>.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#citation">Citation</a></li>
      <li><a href="#installation">Installation</a></li>
      <li>
<a href="#using-biocor">Using BioCor</a><ul class="nav nav-pills nav-stacked">
<li><a href="#preparation">Preparation</a></li>
      <li><a href="#pathway-similarities">Pathway similarities</a></li>
      <li><a href="#geneSim">Gene similarities</a></li>
      <li><a href="#gene-cluster-similarities">Gene cluster similarities</a></li>
      <li><a href="#D2J">Converting similarities</a></li>
      </ul>
</li>
      <li><a href="#high-volumes-of-gene-similarities">High volumes of gene similarities</a></li>
      <li><a href="#an-example-of-usage">An example of usage</a></li>
      <li><a href="#comparing-with-gosemsim">Comparing with GOSemSim</a></li>
      <li><a href="#wgcna-and-biocor">WGCNA and BioCor</a></li>
      <li>
<a href="#faq">FAQ</a><ul class="nav nav-pills nav-stacked">
<li><a href="#FAQ1">How is defined the pathway similarity?</a></li>
      <li><a href="#why-does-biocor-use-the-dice-coefficient-and-not-the-jaccard">Why does BioCor use the dice coefficient and not the Jaccard ?</a></li>
      <li><a href="#how-does-biocor-combine-similarities-between-several-pathways-of-two-genes">How does BioCor combine similarities between several pathways of two genes?</a></li>
      <li><a href="#why-do-you-recommend-using-the-max-method-to-combine-similarities-scores-for-pathways">Why do you recommend using the max method to combine similarities scores for pathways?</a></li>
      <li><a href="#how-to-detect-which-functional-relationship-is-more-important-between-two-genes">How to detect which functional relationship is more important between two genes?</a></li>
      <li><a href="#how-to-detect-with-which-genes-is-my-gene-of-interest-related">How to detect with which genes is my gene of interest related?</a></li>
      <li><a href="#why-isnt-available-a-method-for-calculating-go-similarities">Why isn’t available a method for calculating GO similarities?</a></li>
      <li><a href="#conflict">I get an error! How do I solve this?</a></li>
      </ul>
</li>
      <li><a href="#session-info">Session Info</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lluís Revilla Sancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
