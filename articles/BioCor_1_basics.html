<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BioCor">
<title>About BioCor • BioCor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="About BioCor">
<meta property="og:description" content="BioCor">
<meta property="og:image" content="man/figures/logo.png">
<meta property="og:image:alt" content="BioCor logo">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@Lluis_Revilla">
<meta name="twitter:site" content="@Lluis_Revilla">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BioCor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.19.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BioCor_1_basics.html">About BioCor</a>
    <a class="dropdown-item" href="../articles/BioCor_2_advanced.html">Advanced usage of BioCor</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/llrs/BioCor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>About BioCor</h1>
                        <h4 data-toc-skip class="author">Lluís Revilla</h4>
            <address class="author_afil">
      August Pi i Sunyer Biomedical Research Institute (IDIBAPS); Liver Unit, Hospital Clinic<br><a class="author_email" href="mailto:#"></a><a href="mailto:lrevilla@clinic.cat" class="email">lrevilla@clinic.cat</a>
      </address>
                              <h4 data-toc-skip class="author">Juan José Lozano</h4>
            <address class="author_afil">
      Centro de Investigación Biomédica en Red de Enfermedades Hepaticas y Digestivas (CIBEREHD); Barcelona, Spain<br><h4 data-toc-skip class="author">Pau Sancho-Bru</h4>
            <address class="author_afil">
      August Pi i Sunyer Biomedical Research Institute (IDIBAPS); Liver Unit, Hospital Clinic<br><h4 data-toc-skip class="date">13 February 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/llrs/BioCor/blob/HEAD/vignettes/BioCor_1_basics.Rmd" class="external-link"><code>vignettes/BioCor_1_basics.Rmd</code></a></small>
      <div class="d-none name"><code>BioCor_1_basics.Rmd</code></div>
    </address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Describes the background of the package, important functions defined in the package and some of the applications and usages, including the integration with other packages and analysis, and comparisons with related packages. Some frequent or important questions about the package are answered at the end of the document. For more advanced usage you can look at the other vignette.</p>
    </div>
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Methods to find similarities have been developed for several purposes, being Jaccard and Dice similarities the most known. In bioinformatics much of the research on the topic is centered around <a href="https://www.geneontology.org/" class="external-link">Gene Ontologies</a> because they provide controlled vocabularies, as part of their mission:</p>
<blockquote>
<p>The mission of the GO Consortium is to develop an up-to-date, comprehensive, computational model of biological systems, from the molecular level to larger pathways, cellular and organism-level systems.</p>
</blockquote>
<p>However, there is another resource of similarities between genes: metabolic pathways. Metabolic pathways describe the relationship between genes, proteins, lipids and other elements of the cells. A pathway describes, to some extent, the function in which it is involved in the cell. There exists several databases about which gene belong to which pathway. Together with pathways, gene sets related to a function or to a phenotype are a source of information of the genes function. With this package we provide the methods to calculate functional similarities based on this information.</p>
<p>Here we provides functions to calculate <em>functional similarities distances</em> for pathways, gene sets, genes and clusters of genes. The name BioCor stands from biological correlation, shortened to BioCor, because as said we look if some genes are in the same pathways or gene sets as other genes.</p>
<p>BioCor is different from <em><a href="https://bioconductor.org/packages/3.14/GeneOverlap" class="external-link">GeneOverlap</a></em> because here we use the Dice index instead of the Jaccard index (although we provide a function to change from one to the other, see <a href="#D2J">this section</a>)and that package only allows to compare pathways but not genes or groups of genes. But <em><a href="https://bioconductor.org/packages/3.14/GeneOverlap" class="external-link">GeneOverlap</a></em> provides some functionalities to plot the similarity scores and provides the associated p-value to the comparison of pathways.</p>
<p>The development of this package aimed initially to improve clustering of genes by functionality in weighted gene co-expression networks using <em><a href="https://CRAN.R-project.org/package=WGCNA" class="external-link">WGCNA</a></em>. The package has some functions to combine similarities in order to integrate with <code>WGCNA</code>. For other uses you can check the <a href="https://bioconductor.org/packages/3.14/BioCor/vignettes/BioCor_2_advanced.html" class="external-link">advanced vignette.</a>.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>You can cite the package as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"BioCor"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The BioCor package is available at <a href="https://bioconductor.org" class="external-link">Bioconductor</a> and can be downloaded and installed via BiocManager:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"BioCor"</span><span class="op">)</span></code></pre></div>
<p>You can install the latest version of <em><a href="https://github.com/llrs/BioCor" class="external-link">BioCor</a></em> from Github with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span>
<span class="fu">install_github</span><span class="op">(</span><span class="st">"llrs/BioCor"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-biocor">Using BioCor<a class="anchor" aria-label="anchor" href="#using-biocor"></a>
</h2>
<div class="section level3">
<h3 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h3>
<p>We can load the package and prepare the data for which we want to calculate the similarities:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.org/packages/BioCor" class="external-link">"BioCor"</a></span><span class="op">)</span>
<span class="co">## Load libraries with the data of the pathways</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"org.Hs.eg.db"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"reactome.db"</span><span class="op">)</span>
<span class="va">genesKegg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/BimapFormatting.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">org.Hs.egPATH</span><span class="op">)</span>
<span class="va">genesReact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/BimapFormatting.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">reactomeEXTID2PATHID</span><span class="op">)</span>
<span class="co"># Remove genes and pathways which are not from human pathways </span>
<span class="va">genesReact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">genesReact</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"R-HSA-"</span>, <span class="va">x</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="va">genesReact</span> <span class="op">&lt;-</span> <span class="va">genesReact</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">genesReact</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">]</span> </code></pre></div>
<p>To avoid having biased data it is important to have all the data about the pathways and genes associated to all pathways for the organism under study. Here we assume that we are interested in human pathways. We use this two databases KEGG and Reactome as they are easy to obtain the data. However KEGG database is no longer free for large retrievals therefore it is not longer updated in the Bioconductor annotation packages.</p>
<p>However, one can use any list where the names of the list are the genes and the elements of the list the pathways or groups where the gene belong. One could also read from a GMT file or use GeneSetCollections in addition or instead of those associations from a pathway database and convert it to list using:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"GSEABase"</span><span class="op">)</span>
<span class="va">paths2Genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-class.html" class="external-link">geneIds</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/getObjects.html" class="external-link">getGmt</a></span><span class="op">(</span><span class="st">"/path/to/file.symbol.gmt"</span>,
                 geneIdType<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneIdentifierType-constructors.html" class="external-link">SymbolIdentifier</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">paths2Genes</span>, use.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">paths2Genes</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">paths2Genes</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes2paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">pathways</span>, <span class="va">genes</span><span class="op">)</span> <span class="co"># List of genes and the gene sets</span></code></pre></div>
<p>With <code>genes2paths</code> we have the information ready to use.</p>
</div>
<div class="section level3">
<h3 id="pathway-similarities">Pathway similarities<a class="anchor" aria-label="anchor" href="#pathway-similarities"></a>
</h3>
<p>We can compute similarities (Dice similarity, see <a href="#FAQ1">question 1</a> of FAQ) between two pathways or between several pathways and combine them, or not:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">genesReact</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] "R-HSA-1483101" "R-HSA-9028335"</span>
<span class="fu"><a href="../reference/pathSim.html">pathSim</a></span><span class="op">(</span><span class="va">paths</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">paths</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="co">## [1] 0</span>

<span class="op">(</span><span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">genesReact</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">##  [1] "R-HSA-72203"   "R-HSA-9665245" "R-HSA-9036092" "R-HSA-6811555"</span>
<span class="co">##  [5] "R-HSA-2691230" "R-HSA-75953"   "R-HSA-5637815" "R-HSA-167287" </span>
<span class="co">##  [9] "R-HSA-2206285" "R-HSA-3656234"</span>
<span class="fu"><a href="../reference/mpathSim.html">mpathSim</a></span><span class="op">(</span><span class="va">pathways</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="co">##               R-HSA-72203 R-HSA-9665245 R-HSA-9036092 R-HSA-6811555</span>
<span class="co">## R-HSA-72203    1.00000000      0.000000             0             0</span>
<span class="co">## R-HSA-9665245  0.00000000      1.000000             0             0</span>
<span class="co">## R-HSA-9036092  0.00000000      0.000000             1             0</span>
<span class="co">## R-HSA-6811555  0.00000000      0.000000             0             1</span>
<span class="co">## R-HSA-2691230  0.00000000      0.000000             0             0</span>
<span class="co">## R-HSA-75953    0.09621993      0.000000             0             0</span>
<span class="co">## R-HSA-5637815  0.00000000      0.173913             0             0</span>
<span class="co">## R-HSA-167287   0.10000000      0.000000             0             0</span>
<span class="co">## R-HSA-2206285  0.00000000      0.000000             0             0</span>
<span class="co">## R-HSA-3656234  0.00000000      0.000000             0             0</span>
<span class="co">##               R-HSA-2691230 R-HSA-75953 R-HSA-5637815 R-HSA-167287</span>
<span class="co">## R-HSA-72203       0.0000000  0.09621993     0.0000000    0.1000000</span>
<span class="co">## R-HSA-9665245     0.0000000  0.00000000     0.1739130    0.0000000</span>
<span class="co">## R-HSA-9036092     0.0000000  0.00000000     0.0000000    0.0000000</span>
<span class="co">## R-HSA-6811555     0.0000000  0.00000000     0.0000000    0.0000000</span>
<span class="co">## R-HSA-2691230     1.0000000  0.00000000     0.2352941    0.0000000</span>
<span class="co">## R-HSA-75953       0.0000000  1.00000000     0.0000000    0.3373494</span>
<span class="co">## R-HSA-5637815     0.2352941  0.00000000     1.0000000    0.0000000</span>
<span class="co">## R-HSA-167287      0.0000000  0.33734940     0.0000000    1.0000000</span>
<span class="co">## R-HSA-2206285     0.0000000  0.00000000     0.0000000    0.0000000</span>
<span class="co">## R-HSA-3656234     0.0000000  0.00000000     0.0000000    0.0000000</span>
<span class="co">##               R-HSA-2206285 R-HSA-3656234</span>
<span class="co">## R-HSA-72203               0             0</span>
<span class="co">## R-HSA-9665245             0             0</span>
<span class="co">## R-HSA-9036092             0             0</span>
<span class="co">## R-HSA-6811555             0             0</span>
<span class="co">## R-HSA-2691230             0             0</span>
<span class="co">## R-HSA-75953               0             0</span>
<span class="co">## R-HSA-5637815             0             0</span>
<span class="co">## R-HSA-167287              0             0</span>
<span class="co">## R-HSA-2206285             1             0</span>
<span class="co">## R-HSA-3656234             0             1</span></code></pre></div>
<p>When the method to combine the similarities is set to <code>NULL</code> mpathSim returns a matrix of pathway similarities, otherwise it combines the values. In the next section we can see the methods to combine pathway similarities.</p>
<div class="section level4">
<h4 id="combining">Combining values<a class="anchor" aria-label="anchor" href="#combining"></a>
</h4>
<p>To combine values we provide a function with several methods:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpathSim.html">mpathSim</a></span><span class="op">(</span><span class="va">pathways</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="va">methodsCombineScores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avg"</span>, <span class="st">"max"</span>, <span class="st">"rcmax"</span>, <span class="st">"rcmax.avg"</span>, <span class="st">"BMA"</span>,
                          <span class="st">"reciprocal"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">methodsCombineScores</span>, <span class="fu">BioCor</span><span class="fu">::</span><span class="va"><a href="../reference/combineScores.html">combineScores</a></span>, scores <span class="op">=</span> <span class="va">sim</span><span class="op">)</span>
<span class="co">##        avg        max      rcmax  rcmax.avg        BMA reciprocal </span>
<span class="co">##  0.1188555  1.0000000  1.0000000  1.0000000  1.0000000  1.0000000</span></code></pre></div>
<p>We can also specify the method to combine the similarities in <code>mpathSim</code>, <code>geneSim</code>, <code>mgeneSim</code>, <code>clusterSim</code>, <code>mclusterSim</code>, <code>clusterGeneSim</code> and <code>mclusterGeneSim</code>, argument method. By default the method is set to “max” to combine pathways (except in mpathSim where the default is to show all the pathway similarities) and “BMA” to combine similarities of genes or for cluster analysis. This function is adapted from <em><a href="https://bioconductor.org/packages/3.14/GOSemSim" class="external-link">GOSemSim</a></em> package.</p>
<p>The function <code>combineScoresPar</code> allows to use a parallel background (using <em><a href="https://bioconductor.org/packages/3.14/BiocParallel" class="external-link">BiocParallel</a></em>) to combine the scores. It is recommended to use a parallel background if you calculate more than 300 gene similarities. It also have an argument in case you want to calculate the similarity scores of several sets.</p>
</div>
</div>
<div class="section level3">
<h3 id="geneSim">Gene similarities<a class="anchor" aria-label="anchor" href="#geneSim"></a>
</h3>
<p>To compare the function of two genes there is the <code>geneSim</code> function and <code>mgeneSim</code> function for several comparisons. In this example we compare the genes BRCA1 and BRCA2 and NAT2, which are the genes 672, 675 and 10 respectively in ENTREZID:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/geneSim.html">geneSim</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span>, <span class="va">genesKegg</span><span class="op">)</span>
<span class="co">## [1] 0.0824295</span>
<span class="fu"><a href="../reference/geneSim.html">geneSim</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="co">## [1] 1</span>

<span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span> <span class="op">=</span> <span class="st">"672"</span>, <span class="st">"BRCA2"</span> <span class="op">=</span> <span class="st">"675"</span>, <span class="st">"NAT2"</span> <span class="op">=</span> <span class="st">"10"</span><span class="op">)</span>, <span class="va">genesKegg</span><span class="op">)</span>
<span class="co">##           BRCA1       BRCA2        NAT2</span>
<span class="co">## BRCA1 1.0000000 0.082429501 0.000000000</span>
<span class="co">## BRCA2 0.0824295 1.000000000 0.008241758</span>
<span class="co">## NAT2  0.0000000 0.008241758 1.000000000</span>
<span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span> <span class="op">=</span> <span class="st">"672"</span>, <span class="st">"BRCA2"</span> <span class="op">=</span> <span class="st">"675"</span>, <span class="st">"NAT2"</span> <span class="op">=</span> <span class="st">"10"</span><span class="op">)</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="co">##           BRCA1     BRCA2      NAT2</span>
<span class="co">## BRCA1 1.0000000 1.0000000 0.2215643</span>
<span class="co">## BRCA2 1.0000000 1.0000000 0.2215643</span>
<span class="co">## NAT2  0.2215643 0.2215643 1.0000000</span></code></pre></div>
<p>Note that for the same genes each database or list provided has different annotations, which result on different similarity scores. In this example BRCA1 has 3 and 20 pathways in KEGG and Reactome respectively and BRCA2 has 1 and 46 pathways in KEGG and Reactome respectively which results on different scores.</p>
</div>
<div class="section level3">
<h3 id="gene-cluster-similarities">Gene cluster similarities<a class="anchor" aria-label="anchor" href="#gene-cluster-similarities"></a>
</h3>
<p>There are two methods:</p>
<ul>
<li>Combining all the pathways for each cluster and compare between them.</li>
<li>Calculate the similarity between genes of a cluster and the other cluster.</li>
</ul>
<div class="section level4">
<h4 id="clusterSim">By pathways<a class="anchor" aria-label="anchor" href="#clusterSim"></a>
</h4>
<p>As explained, in this method all the pathways of a cluster are compared with all the pathways of the other cluster. If a method to combine pathways similarities is not provided, all pathway similarities are returned:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/clusterSim.html">clusterSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="va">genesKegg</span><span class="op">)</span>
<span class="co">## [1] 0.04210526</span>
<span class="fu"><a href="../reference/clusterSim.html">clusterSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="va">genesKegg</span>, <span class="cn">NULL</span><span class="op">)</span>
<span class="co">##            00230       01100       05340 00232 00983</span>
<span class="co">## 04120 0.00000000 0.000000000 0.011764706     0     0</span>
<span class="co">## 03440 0.04210526 0.006908463 0.000000000     0     0</span>
<span class="co">## 05200 0.00000000 0.008241758 0.005540166     0     0</span>
<span class="co">## 05212 0.00000000 0.001666667 0.019047619     0     0</span>

<span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cluster1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span><span class="op">)</span>,
                 cluster2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span><span class="op">)</span>,
                 cluster3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"18"</span>, <span class="st">"10"</span>, <span class="st">"83"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/mclusterSim.html">mclusterSim</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">genesKegg</span>, <span class="st">"rcmax.avg"</span><span class="op">)</span>
<span class="co">##            cluster1   cluster2   cluster3</span>
<span class="co">## cluster1 1.00000000 0.01587957 0.00256157</span>
<span class="co">## cluster2 0.01587957 1.00000000 0.56412591</span>
<span class="co">## cluster3 0.00256157 0.56412591 1.00000000</span>
<span class="fu"><a href="../reference/mclusterSim.html">mclusterSim</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">genesKegg</span>, <span class="st">"max"</span><span class="op">)</span>
<span class="co">##             cluster1   cluster2    cluster3</span>
<span class="co">## cluster1 1.000000000 0.04210526 0.008241758</span>
<span class="co">## cluster2 0.042105263 1.00000000 1.000000000</span>
<span class="co">## cluster3 0.008241758 1.00000000 1.000000000</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clusterGeneSim">By genes<a class="anchor" aria-label="anchor" href="#clusterGeneSim"></a>
</h4>
<p>In this method first the similarities between each gene is calculated, then the similarity between each group of genes is calculated. Requiring two methods to combine values, the first one to combine pathways similarities and the second one to combine genes similarities. If only one is provided it returns the matrix of similarities of the genes of each cluster:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/clusterGeneSim.html">clusterGeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="va">genesKegg</span><span class="op">)</span>
<span class="co">## [1] 0.02605425</span>
<span class="fu"><a href="../reference/clusterGeneSim.html">clusterGeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"675"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"10"</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="va">genesKegg</span>, <span class="st">"max"</span><span class="op">)</span>
<span class="co">##            100          10  1</span>
<span class="co">## 672 0.01176471 0.000000000 NA</span>
<span class="co">## 675 0.04210526 0.008241758 NA</span>

<span class="fu"><a href="../reference/mclusterGeneSim.html">mclusterGeneSim</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">genesKegg</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"rcmax.avg"</span><span class="op">)</span><span class="op">)</span>
<span class="co">##             cluster1   cluster2    cluster3</span>
<span class="co">## cluster1 1.000000000 0.02605425 0.006181319</span>
<span class="co">## cluster2 0.026054248 1.00000000 1.000000000</span>
<span class="co">## cluster3 0.006181319 1.00000000 1.000000000</span>
<span class="fu"><a href="../reference/mclusterGeneSim.html">mclusterGeneSim</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">genesKegg</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"max"</span><span class="op">)</span><span class="op">)</span>
<span class="co">##             cluster1   cluster2    cluster3</span>
<span class="co">## cluster1 1.000000000 0.04210526 0.008241758</span>
<span class="co">## cluster2 0.042105263 1.00000000 1.000000000</span>
<span class="co">## cluster3 0.008241758 1.00000000 1.000000000</span></code></pre></div>
<p>Note the differences between <code>mclusterGeneSim</code> and <code>mclusterSim</code> in the similarity values of the clusters. If we set <code>method = c("max", "max")</code> in <code>mclusterGeneSim</code> then the similarity between the clusters is the same as <code>clusterSim</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="D2J">Converting similarities<a class="anchor" aria-label="anchor" href="#D2J"></a>
</h3>
<p>If needed, Jaccard similarity can be calculated from Dice similarity using <code>D2J</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/conversions.html">D2J</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span>
<span class="co">##               R-HSA-72203 R-HSA-9665245 R-HSA-9036092 R-HSA-6811555</span>
<span class="co">## R-HSA-72203    1.00000000     0.0000000             0             0</span>
<span class="co">## R-HSA-9665245  0.00000000     1.0000000             0             0</span>
<span class="co">## R-HSA-9036092  0.00000000     0.0000000             1             0</span>
<span class="co">## R-HSA-6811555  0.00000000     0.0000000             0             1</span>
<span class="co">## R-HSA-2691230  0.00000000     0.0000000             0             0</span>
<span class="co">## R-HSA-75953    0.05054152     0.0000000             0             0</span>
<span class="co">## R-HSA-5637815  0.00000000     0.0952381             0             0</span>
<span class="co">## R-HSA-167287   0.05263158     0.0000000             0             0</span>
<span class="co">## R-HSA-2206285  0.00000000     0.0000000             0             0</span>
<span class="co">## R-HSA-3656234  0.00000000     0.0000000             0             0</span>
<span class="co">##               R-HSA-2691230 R-HSA-75953 R-HSA-5637815 R-HSA-167287</span>
<span class="co">## R-HSA-72203       0.0000000  0.05054152     0.0000000   0.05263158</span>
<span class="co">## R-HSA-9665245     0.0000000  0.00000000     0.0952381   0.00000000</span>
<span class="co">## R-HSA-9036092     0.0000000  0.00000000     0.0000000   0.00000000</span>
<span class="co">## R-HSA-6811555     0.0000000  0.00000000     0.0000000   0.00000000</span>
<span class="co">## R-HSA-2691230     1.0000000  0.00000000     0.1333333   0.00000000</span>
<span class="co">## R-HSA-75953       0.0000000  1.00000000     0.0000000   0.20289855</span>
<span class="co">## R-HSA-5637815     0.1333333  0.00000000     1.0000000   0.00000000</span>
<span class="co">## R-HSA-167287      0.0000000  0.20289855     0.0000000   1.00000000</span>
<span class="co">## R-HSA-2206285     0.0000000  0.00000000     0.0000000   0.00000000</span>
<span class="co">## R-HSA-3656234     0.0000000  0.00000000     0.0000000   0.00000000</span>
<span class="co">##               R-HSA-2206285 R-HSA-3656234</span>
<span class="co">## R-HSA-72203               0             0</span>
<span class="co">## R-HSA-9665245             0             0</span>
<span class="co">## R-HSA-9036092             0             0</span>
<span class="co">## R-HSA-6811555             0             0</span>
<span class="co">## R-HSA-2691230             0             0</span>
<span class="co">## R-HSA-75953               0             0</span>
<span class="co">## R-HSA-5637815             0             0</span>
<span class="co">## R-HSA-167287              0             0</span>
<span class="co">## R-HSA-2206285             1             0</span>
<span class="co">## R-HSA-3656234             0             1</span></code></pre></div>
<p>Also if one has a Jaccard similarity and wants a Dice similarity, can use the <code>J2D</code> function.</p>
</div>
</div>
<div class="section level2">
<h2 id="high-volumes-of-gene-similarities">High volumes of gene similarities<a class="anchor" aria-label="anchor" href="#high-volumes-of-gene-similarities"></a>
</h2>
<p>We can compute the whole similarity of genes in KEGG or Reactome by using :</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Omit those genes without a pathway</span>
<span class="va">nas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">genesKegg</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
<span class="va">genesKegg2</span> <span class="op">&lt;-</span> <span class="va">genesKegg</span><span class="op">[</span><span class="op">!</span><span class="va">nas</span><span class="op">]</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genesKegg2</span><span class="op">)</span>, <span class="va">genesKegg2</span>, method  <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></code></pre></div>
<p>It takes around 5 hours in one core but it requires high memory available.</p>
<p>If one doesn’t have such a memory available can compute the similarities by pieces, and then fit it in another matrix with:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AintoB.html">AintoB</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">B</span><span class="op">)</span></code></pre></div>
<p>Usually B is a matrix of size <code>length(genes)</code>, see <code><a href="../reference/AintoB.html">?AintoB</a></code>.</p>
</div>
<div class="section level2">
<h2 id="an-example-of-usage">An example of usage<a class="anchor" aria-label="anchor" href="#an-example-of-usage"></a>
</h2>
<p>In this example I show how to use BioCor to analyse a list of genes by functionality. With a list of genes we are going to see how similar are those genes:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10"</span>, <span class="st">"15"</span>, <span class="st">"16"</span>, <span class="st">"18"</span>, <span class="st">"2"</span>, <span class="st">"9"</span>, <span class="st">"52"</span>, <span class="st">"3855"</span>, <span class="st">"3880"</span>, <span class="st">"644"</span>, 
              <span class="st">"81327"</span>, <span class="st">"9128"</span>, <span class="st">"2073"</span>, <span class="st">"2893"</span>, <span class="st">"5142"</span>, <span class="st">"60"</span>, <span class="st">"210"</span>, <span class="st">"81"</span>, 
              <span class="st">"1352"</span>, <span class="st">"88"</span>, <span class="st">"672"</span>, <span class="st">"675"</span><span class="op">)</span>
<span class="va">genes.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">mapIds</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>, keys <span class="op">=</span> <span class="va">genes.id</span>, keytype <span class="op">=</span> <span class="st">"ENTREZID"</span>, 
                   column <span class="op">=</span> <span class="st">"SYMBOL"</span><span class="op">)</span>
<span class="co">## 'select()' returned 1:1 mapping between keys and columns</span>
<span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genes.id</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">genes.id</span>
<span class="va">react</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="va">genes</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="co">## Warning in mgeneSim(genes, genesReact): Some genes are not in the list provided.</span>
<span class="co">## We remove genes which are not in list (hence the warning):</span>
<span class="va">nan</span> <span class="op">&lt;-</span> <span class="va">genes</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genesReact</span><span class="op">)</span>
<span class="va">react</span> <span class="op">&lt;-</span> <span class="va">react</span><span class="op">[</span><span class="va">nan</span>, <span class="va">nan</span><span class="op">]</span>
<span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">react</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hc</span>, main <span class="op">=</span> <span class="st">"Similarities between genes"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="BioCor_1_basics_files/figure-html/hclust1-1.png" alt="Dendrogram of the similarities of genes according to Reactome." width="700"><p class="caption">
Gene clustering by similarities
</p>
</div>
<p>Now we can see the relationship between the genes. We can group them for a cluster analysis to visualize the relationship between the clusters:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mycl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">hc</span>, h <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">genes</span><span class="op">[</span><span class="va">nan</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mycl</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Removing clusters of just one gene</span>
<span class="op">(</span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="va">clusters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="co">## $`1`</span>
<span class="co">##   NAT2  AANAT   NAT1  BLVRA   ALAD  COX10 </span>
<span class="co">##   "10"   "15"    "9"  "644"  "210" "1352" </span>
<span class="co">## </span>
<span class="co">## $`2`</span>
<span class="co">## AARS1  ACTB BRCA1 </span>
<span class="co">##  "16"  "60" "672" </span>
<span class="co">## </span>
<span class="co">## $`3`</span>
<span class="co">##   ABAT  GRIA4  ACTN2 </span>
<span class="co">##   "18" "2893"   "88" </span>
<span class="co">## </span>
<span class="co">## $`4`</span>
<span class="co">##   A2M ACTN4 </span>
<span class="co">##   "2"  "81" </span>
<span class="co">## </span>
<span class="co">## $`5`</span>
<span class="co">##   KRT7  KRT19 </span>
<span class="co">## "3855" "3880" </span>
<span class="co">## </span>
<span class="co">## $`8`</span>
<span class="co">##  ERCC5  BRCA2 </span>
<span class="co">## "2073"  "675"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cluster"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Remember we can use two methods to compare clusters</span>
<span class="va">sim_clus1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mclusterSim.html">mclusterSim</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">sim_clus1</span><span class="op">)</span><span class="op">)</span>, 
     main <span class="op">=</span> <span class="st">"Similarities between clusters by pathways"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="BioCor_1_basics_files/figure-html/hclust3-1.png" alt="Dendrogram of clusters of genes according to Reactome." width="700"><p class="caption">
Clustering using clusterSim
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_clus2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mclusterGeneSim.html">mclusterGeneSim</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">genesReact</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">sim_clus2</span><span class="op">)</span><span class="op">)</span>, 
     main <span class="op">=</span><span class="st">"Similarities between clusters by genes"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="BioCor_1_basics_files/figure-html/hclust3b-1.png" alt="Dendrogram of clusters according to similarities between genes from Reactome pathways." width="700"><p class="caption">
Clustering using clusterGeneSim
</p>
</div>
<p>Each method results in a different dendrogram as we can see on Figure @ref(fig:hclust3) compared to Figure @ref(fig:hclust3b).</p>
</div>
<div class="section level2">
<h2 id="comparing-with-gosemsim">Comparing with GOSemSim<a class="anchor" aria-label="anchor" href="#comparing-with-gosemsim"></a>
</h2>
<p>In this section I will compare the functional similarity of BioCor with the closely related package <em><a href="https://bioconductor.org/packages/3.14/GOSemSim" class="external-link">GOSemSim</a></em>. The genes and gene clusters used were extracted from GOSemSim’s vignette, we only change the ontology, instead of the molecular function, the biological process will be used:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hsGO</span> <span class="op">&lt;-</span> <span class="fu">GOSemSim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GOSemSim/man/godata.html" class="external-link">godata</a></span><span class="op">(</span><span class="st">'org.Hs.eg.db'</span>, ont <span class="op">=</span> <span class="st">"BP"</span>, computeIC <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## preparing gene to GO mapping data...</span></code></pre></div>
<p>I will compare the functions geneSim from section <a href="https://bioconductor.org/packages/release/bioc/vignettes/GOSemSim/inst/doc/GOSemSim.html#genesim-and-mgenesim" class="external-link">geneSim and mgeneSim from GOSemSim</a> with both data sets from KEGG and Reactome:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">goSemSim</span> <span class="op">&lt;-</span> <span class="fu">GOSemSim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GOSemSim/man/geneSim.html" class="external-link">geneSim</a></span><span class="op">(</span><span class="st">"241"</span>, <span class="st">"251"</span>, semData <span class="op">=</span> <span class="va">hsGO</span>, 
                              measure <span class="op">=</span> <span class="st">"Wang"</span>, combine<span class="op">=</span><span class="st">"BMA"</span><span class="op">)</span>
<span class="co"># In case it is null</span>
<span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">goSemSim</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extract.html" class="external-link">getElement</a></span><span class="op">(</span><span class="va">goSemSim</span>, <span class="st">"geneSim"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">BioCor</span><span class="fu">::</span><span class="fu"><a href="../reference/geneSim.html">geneSim</a></span><span class="op">(</span><span class="st">"241"</span>, <span class="st">"251"</span>, <span class="va">genesReact</span>, <span class="st">"BMA"</span><span class="op">)</span> <span class="op">-</span> <span class="va">sim</span>
<span class="co">##    geneSim        GO1        GO2 </span>
<span class="co">## -0.1127487 -0.1127487 -0.1127487</span>

<span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"835"</span>, <span class="st">"5261"</span>,<span class="st">"241"</span>, <span class="st">"994"</span><span class="op">)</span>
<span class="va">goSemSim</span> <span class="op">&lt;-</span> <span class="fu">GOSemSim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GOSemSim/man/mgeneSim.html" class="external-link">mgeneSim</a></span><span class="op">(</span><span class="va">genes</span>, semData <span class="op">=</span> <span class="va">hsGO</span>, 
                   measure <span class="op">=</span> <span class="st">"Wang"</span>, combine <span class="op">=</span> <span class="st">"BMA"</span>,
                   verbose <span class="op">=</span> <span class="cn">FALSE</span>, drop <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="fu">BioCor</span><span class="fu">::</span><span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="va">genes</span>, <span class="va">genesReact</span>, <span class="st">"BMA"</span>, round <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="va">goSemSim</span>
<span class="co">##         835   5261    241    994</span>
<span class="co">## 835   0.000 -0.095 -0.128 -0.152</span>
<span class="co">## 5261 -0.095  0.000  0.078 -0.258</span>
<span class="co">## 241  -0.128  0.078  0.000 -0.119</span>
<span class="co">## 994  -0.152 -0.258 -0.119  0.000</span></code></pre></div>
<p>We can observe there is more similarity according to the gene ontology than according to the pathways. See FAQ <a href="#conflict">question 8</a> about the use of <code>BioCor::</code> and <code>GOSemSim::</code>.</p>
<p>If named characters are passed they are used to name the resulting matrix:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CDC45"</span>, <span class="st">"MCM10"</span>, <span class="st">"CDC20"</span>, <span class="st">"NMU"</span>, <span class="st">"MMP1"</span><span class="op">)</span>
<span class="va">genese</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">mapIds</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>, keys <span class="op">=</span> <span class="va">genes</span>, column <span class="op">=</span> <span class="st">"ENTREZID"</span>, 
                 keytype <span class="op">=</span> <span class="st">"SYMBOL"</span><span class="op">)</span>
<span class="co">## 'select()' returned 1:1 mapping between keys and columns</span>
<span class="fu">BioCor</span><span class="fu">::</span><span class="fu"><a href="../reference/mgeneSim.html">mgeneSim</a></span><span class="op">(</span><span class="va">genese</span>, <span class="va">genesReact</span>, <span class="st">"BMA"</span><span class="op">)</span>
<span class="co">##           CDC45     MCM10     CDC20       NMU      MMP1</span>
<span class="co">## CDC45 1.0000000 0.9188608 0.5090134 0.0506140 0.0954802</span>
<span class="co">## MCM10 0.9188608 1.0000000 0.5197478 0.0588809 0.1003586</span>
<span class="co">## CDC20 0.5090134 0.5197478 1.0000000 0.1638912 0.2250988</span>
<span class="co">## NMU   0.0506140 0.0588809 0.1638912 1.0000000 0.1147072</span>
<span class="co">## MMP1  0.0954802 0.1003586 0.2250988 0.1147072 1.0000000</span></code></pre></div>
<p>We can further compare the cluster similarities from the <a href="https://bioconductor.org/packages/release/bioc/vignettes/GOSemSim/inst/doc/GOSemSim.html#clustersim-and-mclustersim" class="external-link">next section of the vignette</a>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"835"</span>, <span class="st">"5261"</span>,<span class="st">"241"</span>, <span class="st">"994"</span>, <span class="st">"514"</span>, <span class="st">"533"</span><span class="op">)</span>
<span class="va">gs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"578"</span>,<span class="st">"582"</span>, <span class="st">"400"</span>, <span class="st">"409"</span>, <span class="st">"411"</span><span class="op">)</span>
<span class="fu">BioCor</span><span class="fu">::</span><span class="fu"><a href="../reference/clusterSim.html">clusterSim</a></span><span class="op">(</span><span class="va">gs1</span>, <span class="va">gs2</span>, <span class="va">genesReact</span>, <span class="st">"BMA"</span><span class="op">)</span> <span class="op">-</span> 
    <span class="fu">GOSemSim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GOSemSim/man/clusterSim.html" class="external-link">clusterSim</a></span><span class="op">(</span><span class="va">gs1</span>, <span class="va">gs2</span>, <span class="va">hsGO</span>, measure <span class="op">=</span> <span class="st">"Wang"</span>, combine <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>
<span class="co">## [1] -0.1366985</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">org.Hs.egGO</span>
<span class="va">hsEG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-keys.html" class="external-link">mappedkeys</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="op">(</span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">hsEG</span>, <span class="fl">20</span><span class="op">)</span>, b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">hsEG</span>, <span class="fl">20</span><span class="op">)</span>, c<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">hsEG</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">## $a</span>
<span class="co">##  [1] "100616476" "102466252" "147372"    "114876"    "159686"    "55627"    </span>
<span class="co">##  [7] "23190"     "28639"     "81392"     "140690"    "5764"      "429"      </span>
<span class="co">## [13] "51267"     "645402"    "1447"      "27250"     "112441435" "4780"     </span>
<span class="co">## [19] "57455"     "27333"    </span>
<span class="co">## </span>
<span class="co">## $b</span>
<span class="co">##  [1] "11218"  "84861"  "6705"   "7565"   "441933" "50945"  "414189" "7682"  </span>
<span class="co">##  [9] "8878"   "147700" "391123" "3576"   "201501" "642517" "387707" "84141" </span>
<span class="co">## [17] "5422"   "27336"  "92597"  "729408"</span>
<span class="co">## </span>
<span class="co">## $c</span>
<span class="co">##  [1] "130813"    "30850"     "23584"     "84275"     "389658"    "64794"    </span>
<span class="co">##  [7] "100033447" "6897"      "3183"      "30818"     "80301"     "54718"    </span>
<span class="co">## [13] "102465493" "286365"    "55316"     "390502"    "51046"     "51348"    </span>
<span class="co">## [19] "57156"     "9744"</span>
<span class="fu">BioCor</span><span class="fu">::</span><span class="fu"><a href="../reference/mclusterSim.html">mclusterSim</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">genesReact</span>, <span class="st">"BMA"</span><span class="op">)</span> <span class="op">-</span> 
    <span class="fu">GOSemSim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GOSemSim/man/mclusterSim.html" class="external-link">mclusterSim</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">hsGO</span>, measure <span class="op">=</span> <span class="st">"Wang"</span>, combine <span class="op">=</span> <span class="st">"BMA"</span><span class="op">)</span>
<span class="co">## Warning in BioCor::mclusterSim(clusters, genesReact, "BMA"): Some genes are not</span>
<span class="co">## in the list provided.</span>
<span class="co">##             a           b           c</span>
<span class="co">## a  0.00000000 -0.03202627 -0.06505804</span>
<span class="co">## b -0.03202627  0.00000000 -0.03453614</span>
<span class="co">## c -0.06505804 -0.03453614  0.00000000</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wgcna-and-biocor">WGCNA and BioCor<a class="anchor" aria-label="anchor" href="#wgcna-and-biocor"></a>
</h2>
<p><em><a href="https://CRAN.R-project.org/package=WGCNA" class="external-link">WGCNA</a></em> uses the correlation of the expression data of several samples to cluster genes. Sometimes, from a biological point of view the interpretation of the resulting modules is difficult, even more when some groups of genes end up not having an enrichment in previously described functions. BioCor was originally thought to be used to overcome this problem: to help clustering genes, not only by correlation but also by functionality.</p>
<p>In order to have groups functionally related, functional similarities can enhance the clustering of genes when combined with experimental correlations. The resulting groups will reflect, not only the correlation of the expression provided, but also the functionality known of those genes.</p>
<p>We propose the following steps:</p>
<ol style="list-style-type: decimal">
<li>Calculate the similarities for the expression data</li>
<li>Calculate the similarities of the genes in the expression</li>
<li>Combine the similarities</li>
<li>Calculate the adjacency</li>
<li>Identify modules with hierarchical clustering</li>
</ol>
<p>Here we provide an example on how to use BioCor with WGCNA:</p>
<p><code>sim</code> is a list where each element is a matrix of similarities between genes Our normalized expression is in the <code>expr</code> variable, a matrix where the samples are in the rows and genes in the columns.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">expr.sim</span> <span class="op">&lt;-</span> <span class="fu">WGCNA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">expr</span><span class="op">)</span> <span class="co"># or bicor</span>

<span class="co">## Combine the similarities</span>
<span class="va">similarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarities.html">similarities</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="va">expr.sim</span><span class="op">)</span>, <span class="va">sim</span><span class="op">)</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## Choose the softThreshold</span>
<span class="va">pSFT</span> <span class="op">&lt;-</span> <span class="fu">pickSoftThreshold.fromSimilarity</span><span class="op">(</span><span class="va">similarity</span><span class="op">)</span>

<span class="co">## Or any other function we want</span>
<span class="va">adjacency</span> <span class="op">&lt;-</span> <span class="fu">adjacency.fromSimilarity</span><span class="op">(</span><span class="va">similarity</span>, power <span class="op">=</span> <span class="va">pSFT</span><span class="op">$</span><span class="va">powerEstimate</span><span class="op">)</span>

<span class="co">## Once we have the similarities we can calculate the TOM with TOM</span>
<span class="va">TOM</span> <span class="op">&lt;-</span> <span class="fu">TOMsimilarity</span><span class="op">(</span><span class="va">adjacency</span><span class="op">)</span> <span class="co">## Requires adjacencies despite its name </span>
<span class="va">dissTOM</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">TOM</span>
<span class="va">geneTree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissTOM</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>
<span class="co">## We can use a clustering tool to group the genes</span>
<span class="va">dynamicMods</span> <span class="op">&lt;-</span> <span class="fu">cutreeHybrid</span><span class="op">(</span>dendro <span class="op">=</span> <span class="va">geneTree</span>, distM <span class="op">=</span> <span class="va">dissTOM</span>,
                            deepSplit <span class="op">=</span> <span class="fl">2</span>, pamRespectsDendro <span class="op">=</span> <span class="cn">FALSE</span>,
                            minClusterSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">moduleColors</span> <span class="op">&lt;-</span> <span class="fu">labels2colors</span><span class="op">(</span><span class="va">dynamicMods</span><span class="op">$</span><span class="va">labels</span><span class="op">)</span></code></pre></div>
<p>Once the modules are identified using the functional similarities of this package and the gene correlations, one can continue with the workflow of WGCNA.</p>
<p>An important aspect in this process is deciding how to combine the similarities and the expression data: - If the functional similarities play a huge role, we will end up having only those genes closely related to the same functions. - If the functional similarities play a low role, it will be similarly to only use WGCNA, and the genes won’t be functionally related.</p>
<p>For these reasons it is better to use weights between <code>0.5</code> and <code>1</code> for expression if you use <code>weighted.sum</code> or similar functions.</p>
<p>There are several things to take into account when choosing a way to combine: - The size of the gray or 0 modules (those who don’t show a specific pattern) - The number and size of the modules created. - The way the similarities are combined</p>
<p>Violin plots may help to view the differences in size and distribution of the modules across different methods of combining the similarities.</p>
</div>
<div class="section level2">
<h2 id="faq">FAQ<a class="anchor" aria-label="anchor" href="#faq"></a>
</h2>
<div class="section level3">
<h3 id="FAQ1">How is defined the pathway similarity?<a class="anchor" aria-label="anchor" href="#FAQ1"></a>
</h3>
<p>BioCor uses the <a href="https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient" class="external-link">Sørensen–Dice index</a>: The dice similarity is the double of the genes shared by the pathways divided by the number of genes in each pathway.</p>
<p>We can calculate the similarity between two pathways (<span class="math inline">\(x\)</span>, <span class="math inline">\(w\)</span>) with:</p>
<p><span class="math display">\[Dice(x, w) = \frac{2 |x \cap w|}{|x| + |w|}\]</span></p>
<p>This is implemented in the <code>diceSim</code> function, which results is similar to Jaccard index:</p>
<p><span class="math display">\[Jaccard(x, w) = \frac{|x \cap w|}{|x \cup w|}\]</span></p>
<p>Both Jaccard index and dice index are between 0 and 1 (<span class="math inline">\([0, 1]\)</span>). To calculate the Jaccard index from the <code>diceSim</code> use the <code>D2J</code> function.</p>
</div>
<div class="section level3">
<h3 id="why-does-biocor-use-the-dice-coefficient-and-not-the-jaccard">Why does BioCor use the dice coefficient and not the Jaccard ?<a class="anchor" aria-label="anchor" href="#why-does-biocor-use-the-dice-coefficient-and-not-the-jaccard"></a>
</h3>
<p>We consider Dice coefficient better than Jaccard because it has higher values for the same comparisons, which reflects that including a gene in a pathway is not easily done.</p>
</div>
<div class="section level3">
<h3 id="how-does-biocor-combine-similarities-between-several-pathways-of-two-genes">How does BioCor combine similarities between several pathways of two genes?<a class="anchor" aria-label="anchor" href="#how-does-biocor-combine-similarities-between-several-pathways-of-two-genes"></a>
</h3>
<p>Although the recommend method is the “max” method, (set as default), there are implemented other methods in <code>combineScores</code> of the <em><a href="https://bioconductor.org/packages/3.14/GOSemSim" class="external-link">GOSemSim</a></em> package which I borrowed<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See the &lt;a href="#combining"&gt;Combining values section&lt;/a&gt; and the help page of &lt;code&gt;combineScores&lt;/code&gt;.&lt;/p&gt;'><sup>1</sup></a>.</p>
</div>
<div class="section level3">
<h3 id="why-do-you-recommend-using-the-max-method-to-combine-similarities-scores-for-pathways">Why do you recommend using the max method to combine similarities scores for pathways?<a class="anchor" aria-label="anchor" href="#why-do-you-recommend-using-the-max-method-to-combine-similarities-scores-for-pathways"></a>
</h3>
<p>The purpose of combining the scores is usually to find the relationships between genes through their pathways. The higher the similarity is between two pathway of two genes, the higher functionality do the genes share, even if those genes have other non-related functions.</p>
</div>
<div class="section level3">
<h3 id="how-to-detect-which-functional-relationship-is-more-important-between-two-genes">How to detect which functional relationship is more important between two genes?<a class="anchor" aria-label="anchor" href="#how-to-detect-which-functional-relationship-is-more-important-between-two-genes"></a>
</h3>
<p>If two genes are involved in the same pathways usually they have (to some extent, maybe indirect) interactions. To detect which relationship is more important between two genes one could measure other similarities scores and check the stoichiometry of the pathways and measure the expression changes and correlation between them or use dynamic simulations of the pathways.</p>
</div>
<div class="section level3">
<h3 id="how-to-detect-with-which-genes-is-my-gene-of-interest-related">How to detect with which genes is my gene of interest related?<a class="anchor" aria-label="anchor" href="#how-to-detect-with-which-genes-is-my-gene-of-interest-related"></a>
</h3>
<p>You can measure the <a href="#geneSim">gene similarity</a> between those genes and also measure the expression correlation of your gene of interest with other genes.</p>
</div>
<div class="section level3">
<h3 id="why-isnt-available-a-method-for-calculating-go-similarities">Why isn’t available a method for calculating GO similarities?<a class="anchor" aria-label="anchor" href="#why-isnt-available-a-method-for-calculating-go-similarities"></a>
</h3>
<p>This is covered by the <em><a href="https://bioconductor.org/packages/3.14/GOSemSim" class="external-link">GOSemSim</a></em> package, you can use it to produce a similarity matrix (i.e. use <code>mgeneSim</code>). You can parallelize it with <code>foreach</code> package or <code>BiocParallel</code> if your list of genes is big.</p>
</div>
<div class="section level3">
<h3 id="conflict">I get an error! How do I solve this?<a class="anchor" aria-label="anchor" href="#conflict"></a>
</h3>
<p>If the error is like this:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">FUN</span>(X[[i]], ...) <span class="sc">:</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  trying to get slot <span class="st">"geneAnno"</span> from an object of a basic <span class="fu">class</span> (<span class="st">"list"</span>) with no slots</span></code></pre></div>
<p>And you have loaded the <code>GOSemSim</code> library, R is calling the GOSemSim function of the same name. Use <code>BioCor::</code> to call the function from <code>BioCor</code> (f.ex: <code><a href="../reference/geneSim.html">BioCor::geneSim</a></code>)</p>
<p>If the error is not previously described in the <a href="https:support.bioconductor.org">support forum</a>, post a question there.</p>
<p>My apologies if you found a bug or an inconsistency between what <code>BioCor</code> should do and what it actually does. Once you checked that it is a bug, please let me know at the <em><a href="https://github.com/llrs/BioCor/issues" class="external-link">issues</a></em> page of Github.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## R version 4.1.2 (2021-11-01)</span>
<span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">## Running under: Ubuntu 20.04.3 LTS</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0</span>
<span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span>
<span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span>
<span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span>
<span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span>
<span class="co">## [8] base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">## [1] reactome.db_1.77.0   org.Hs.eg.db_3.14.0  AnnotationDbi_1.56.2</span>
<span class="co">## [4] IRanges_2.28.0       S4Vectors_0.32.3     Biobase_2.54.0      </span>
<span class="co">## [7] BiocGenerics_0.40.0  BioCor_1.19.2        BiocStyle_2.22.0    </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] Rcpp_1.0.8             lattice_0.20-45        GO.db_3.14.0          </span>
<span class="co">##  [4] png_0.1-7              Biostrings_2.62.0      rprojroot_2.0.2       </span>
<span class="co">##  [7] digest_0.6.29          R6_2.5.1               GenomeInfoDb_1.30.1   </span>
<span class="co">## [10] RSQLite_2.2.9          evaluate_0.14          highr_0.9             </span>
<span class="co">## [13] httr_1.4.2             zlibbioc_1.40.0        rlang_1.0.1           </span>
<span class="co">## [16] annotate_1.72.0        jquerylib_0.1.4        blob_1.2.2            </span>
<span class="co">## [19] Matrix_1.3-4           rmarkdown_2.11         pkgdown_2.0.2         </span>
<span class="co">## [22] textshaping_0.3.6      desc_1.4.0             BiocParallel_1.28.3   </span>
<span class="co">## [25] stringr_1.4.0          RCurl_1.98-1.6         bit_4.0.4             </span>
<span class="co">## [28] compiler_4.1.2         xfun_0.29              pkgconfig_2.0.3       </span>
<span class="co">## [31] systemfonts_1.0.3      htmltools_0.5.2        KEGGREST_1.34.0       </span>
<span class="co">## [34] GenomeInfoDbData_1.2.7 bookdown_0.24          XML_3.99-0.3          </span>
<span class="co">## [37] crayon_1.4.2           bitops_1.0-7           grid_4.1.2            </span>
<span class="co">## [40] jsonlite_1.7.3         xtable_1.8-4           GSEABase_1.56.0       </span>
<span class="co">## [43] DBI_1.1.2              magrittr_2.0.2         graph_1.72.0          </span>
<span class="co">## [46] GOSemSim_2.20.0        cli_3.1.1              stringi_1.7.6         </span>
<span class="co">## [49] cachem_1.0.6           XVector_0.34.0         fs_1.5.2              </span>
<span class="co">## [52] bslib_0.3.1            ragg_1.2.1             vctrs_0.3.8           </span>
<span class="co">## [55] tools_4.1.2            bit64_4.0.5            purrr_0.3.4           </span>
<span class="co">## [58] parallel_4.1.2         fastmap_1.1.0          yaml_2.2.2            </span>
<span class="co">## [61] BiocManager_1.30.16    memoise_2.0.1          knitr_1.37            </span>
<span class="co">## [64] sass_0.4.0</span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lluís Revilla Sancho.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
